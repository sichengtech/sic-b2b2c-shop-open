function validateData(t){return void 0!==t&&""!=t}function getRealGoods(t,e){var a=jQuery.Deferred(),n=getArea();return jQuery.ajax({url:INTERFACE.realSku.partition,data:{skuIds:t,area:n,cat:"0,0,0",app:"test",bizType:0},dataType:"jsonp",success:function(t){jQuery.ajax({url:INTERFACE.actJshop.goodsInfo,data:{skuIds:makeSkuids(t)},dataType:"jsonp",success:function(e){a.resolve(e,t)}})}}),a.promise()}function getArea(){return(CookieUtil.getCookie("ipLoc-djd")?CookieUtil.getCookie("ipLoc-djd"):"1-72-0-0").split("-").join("_").split(".")[0]}function makeSkuids(t){var e=[];return jQuery.map(t,function(t,a){e.push(t.realSkuId)}),e.join(",")}function makeTpltoHtml(t,e){var a="",n=$.Deferred();return seajs.use("public/utils/JsonUtils",function(o){for(var i=0;i<t.length;i++)a+=o.render(t[i],e);n.resolve(a)}),n}function getArray(t,e){a=[];for(var n=t,o=e;n<=o;n++)a.push(n);return a}function getServerTime(t){var e=INTERFACE.actJshop.serverTime;$.ajax({url:e,type:"GET",cache:!1,dataType:"jsonp",success:function(e){t&&t(e.nowTime?new Date(e.nowTime):new Date)}})}function Slot(){this.options={startVal:0,changeVal:0,duration:0,startTime:0,step:2,result:0,complete:jQuery.noop},this.init=function(){for(var t=this.options,e=0,a=["webkit","moz","ms"],n=0;n<a.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[a[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[a[n]+"CancelAnimationFrame"]||window[a[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,a){var n=(new Date).getTime(),o=Math.max(0,16-(n-e)),i=window.setTimeout(function(){t(n+o)},o);return e=n+o,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)}),this.target=this.el,this.startVal=+t.startVal,this.changeVal=+t.endVal,this.result=t.result,this.startTime=t.startTime,this.duration=t.duration,this.step=t.step,this.complete=t.complete,this.start()},this.tween={Linear:function(t,e,a,n){return a*t/n+e},Quad:{easeIn:function(t,e,a,n){return a*(t/=n)*t+e},easeOut:function(t,e,a,n){return-a*(t/=n)*(t-2)+e},easeInOut:function(t,e,a,n){return(t/=n/2)<1?a/2*t*t+e:-a/2*(--t*(t-2)-1)+e}},Cubic:{easeIn:function(t,e,a,n){return a*(t/=n)*t*t+e},easeOut:function(t,e,a,n){return a*((t=t/n-1)*t*t+1)+e},easeInOut:function(t,e,a,n){return(t/=n/2)<1?a/2*t*t*t+e:a/2*((t-=2)*t*t+2)+e}},Quart:{easeIn:function(t,e,a,n){return a*(t/=n)*t*t*t+e},easeOut:function(t,e,a,n){return-a*((t=t/n-1)*t*t*t-1)+e},easeInOut:function(t,e,a,n){return(t/=n/2)<1?a/2*t*t*t*t+e:-a/2*((t-=2)*t*t*t-2)+e}},Quint:{easeIn:function(t,e,a,n){return a*(t/=n)*t*t*t*t+e},easeOut:function(t,e,a,n){return a*((t=t/n-1)*t*t*t*t+1)+e},easeInOut:function(t,e,a,n){return(t/=n/2)<1?a/2*t*t*t*t*t+e:a/2*((t-=2)*t*t*t*t+2)+e}},Sine:{easeIn:function(t,e,a,n){return-a*Math.cos(t/n*(Math.PI/2))+a+e},easeOut:function(t,e,a,n){return a*Math.sin(t/n*(Math.PI/2))+e},easeInOut:function(t,e,a,n){return-a/2*(Math.cos(Math.PI*t/n)-1)+e}},Expo:{easeIn:function(t,e,a,n){return 0==t?e:a*Math.pow(2,10*(t/n-1))+e},easeOut:function(t,e,a,n){return t==n?e+a:a*(1-Math.pow(2,-10*t/n))+e},easeInOut:function(t,e,a,n){return 0==t?e:t==n?e+a:(t/=n/2)<1?a/2*Math.pow(2,10*(t-1))+e:a/2*(2-Math.pow(2,-10*--t))+e}},Circ:{easeIn:function(t,e,a,n){return-a*(Math.sqrt(1-(t/=n)*t)-1)+e},easeOut:function(t,e,a,n){return a*Math.sqrt(1-(t=t/n-1)*t)+e},easeInOut:function(t,e,a,n){return(t/=n/2)<1?-a/2*(Math.sqrt(1-t*t)-1)+e:a/2*(Math.sqrt(1-(t-=2)*t)+1)+e}},Elastic:{easeIn:function(t,e,a,n,o,i){var r;return 0==t?e:1==(t/=n)?e+a:(void 0===i&&(i=.3*n),!o||o<Math.abs(a)?(r=i/4,o=a):r=i/(2*Math.PI)*Math.asin(a/o),-o*Math.pow(2,10*(t-=1))*Math.sin((t*n-r)*(2*Math.PI)/i)+e)},easeOut:function(t,e,a,n,o,i){var r;return 0==t?e:1==(t/=n)?e+a:(void 0===i&&(i=.3*n),!o||o<Math.abs(a)?(o=a,r=i/4):r=i/(2*Math.PI)*Math.asin(a/o),o*Math.pow(2,-10*t)*Math.sin((t*n-r)*(2*Math.PI)/i)+a+e)},easeInOut:function(t,e,a,n,o,i){var r;return 0==t?e:2==(t/=n/2)?e+a:(void 0===i&&(i=n*(.3*1.5)),!o||o<Math.abs(a)?(o=a,r=i/4):r=i/(2*Math.PI)*Math.asin(a/o),t<1?o*Math.pow(2,10*(t-=1))*Math.sin((t*n-r)*(2*Math.PI)/i)*-.5+e:o*Math.pow(2,-10*(t-=1))*Math.sin((t*n-r)*(2*Math.PI)/i)*.5+a+e)}},Back:{easeIn:function(t,e,a,n,o){return void 0===o&&(o=1.70158),a*(t/=n)*t*((o+1)*t-o)+e},easeOut:function(t,e,a,n,o){return void 0===o&&(o=1.70158),a*((t=t/n-1)*t*((o+1)*t+o)+1)+e},easeInOut:function(t,e,a,n,o){return void 0===o&&(o=1.70158),(t/=n/2)<1?a/2*(t*t*((1+(o*=1.525))*t-o))+e:a/2*((t-=2)*t*((1+(o*=1.525))*t+o)+2)+e}},Bounce:{easeIn:function(t,e,a,n){return a-Tween.Bounce.easeOut(n-t,0,a,n)+e},easeOut:function(t,e,a,n){return(t/=n)<1/2.75?a*(7.5625*t*t)+e:t<2/2.75?a*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?a*(7.5625*(t-=2.25/2.75)*t+.9375)+e:a*(7.5625*(t-=2.625/2.75)*t+.984375)+e},easeInOut:function(t,e,a,n){return t<n/2?.5*Tween.Bounce.easeIn(2*t,0,a,n)+e:.5*Tween.Bounce.easeOut(2*t-n,0,a,n)+.5*a+e}}},this.start=function(){this.goal=$(this.target).find("ul"),this.itemHeight=$(this.target).find("li").outerHeight(),this.itemTotalHeight=($(this.target).find("li").length-1)*this.itemHeight,this.changeVal=this.result*this.itemHeight,this.reset(),this.freeRun()},this.freeRun=function(){this.goal.css("marginTop",Math.ceil(this.tween.Quint.easeIn(this.startTime,this.startVal,-1*this.itemTotalHeight,this.duration))),this.startTime<this.duration?(this.startTime+=this.step,this.rAF=requestAnimationFrame(jQuery.proxy(this.freeRun,this))):(this.reset(),this.goalRun())},this.goalRun=function(){this.goal.css("marginTop",Math.ceil(this.tween.Quad.easeOut(this.startTime,this.startVal,-1*this.changeVal,this.duration))),this.startTime<this.duration?(this.startTime+=this.step,this.rAF=requestAnimationFrame(jQuery.proxy(this.goalRun,this))):(this.reset(),this.complete())},this.reset=function(){cancelAnimationFrame(this.rAF),this.startTime=0}}seajs.use("base64");var jshop=jshop||{};jshop.module={removeBg:function(t){var e=$.extend({defaultClass:"noBg"},t),a=$(this).find(e.node),n=parseInt(a.parent().width()/a.outerWidth(!0)),o=e.defaultClass;a.each(function(t,e){!t||((t+1)/n).toString().indexOf(".")>=0?(t+1)/n==1&&$(e).addClass("noBgOne"):$(e).addClass(o)})},waterfallFlow:function(t){function e(t,e){return t<e?-1:t>e?1:0}var a,n=this,o=jQuery.extend({node:"li",topSpac:10},t),i=jQuery(n).find(o.node),r=parseInt(i.parent().width()/parseInt(i.outerWidth(!0))),s=[];i.each(function(t,e){var n=parseInt(t/r),d=t%r,u=d*jQuery(e).outerWidth(!0);if(0==n)a=parseInt(d%2*o.topSpac);else{var c=jQuery(i.get((n-1)*r+d));a=c.outerHeight(!0)+parseInt(c.css("top"))}jQuery(e).css({left:u,top:a}),s.push(parseInt(jQuery(e).css("top"))+jQuery(e).outerHeight(!0))}),s.sort(e),jQuery(n).css("height",s[s.length-1])},changeStyle:function(t){var e=$.extend({node:"li",defaultClass:"jCurrent",defaultShow:0},t),a=$(this).find(e.node),n=e.defaultClass,o=e.defaultShow;a.eq(o).addClass(n),a.each(function(t,e){$(e).mouseenter(function(t){$(this).addClass(n).siblings().removeClass(n)})})},addEllipsis:function(t){if(t){var e=this,a=jQuery.extend({title:"li",count:20,text:"..."},t),n=jQuery(e).find(a.title),o=/\s|\,|\.|\!|\'|\"|\;|\:|\t|\n|\r/g;n.each(function(t,e){var n=e.firstChild,i=n.nodeValue;if(n&&3==n.nodeType&&n.length>=a.count){var r=i.substring(0,a.count-a.text.length),s=i.charAt(a.count-a.text.length);if(o.test(s))n.nodeValue=r+a.text;else{var d=r.match(o);r=r.substring(0,r.lastIndexOf(d[d.length-1])+1)+a.text,n.nodeValue=r}}})}},autoWidth:function(t){var e=$.extend({node:"li",extra:{}},t||{}),a=this,n=$(a).find(e.node),o=n.eq(0);n.css(e.extra);var i=parseInt(o.data("outerWidth")||o.outerWidth(!0)),r=parseInt(o.data("width")||o.css("width")),s=parseInt(o.parent().parent().width()/i);o.data({outerWidth:i,width:r});var d=i-r,u=(o.parent().parent().width()-d*s-.03)/s;n.css({width:u})},autoFill:function(t){function e(){i.css("overflow","hidden"),(r.css("margin-left")||r.css("margin-right"))&&r.css({"margin-left":0,"margin-right":0}),r.css("margin-top",d),r.css("margin-left",s),a()}function a(){var t=i.attr("data-function")?i.attr("data-function"):0;0==t&&i.attr("data-function","autoFill"),t.length>0&&-1==t.indexOf("autoFill")&&i.attr("data-function",t+"autoFill")}var n,o=$.extend({autoFillNode:"li",xInner:0,yInner:0,minWidth:" ",xOuter:" ",yOuter:" ",isEqual:!1,length:""},t||{}),i=$(this),r=i.find(o.autoFillNode),s=parseInt(o.xInner),d=parseInt(o.yInner),u=parseInt(o.minWidth)?parseInt(o.minWidth):r.css({width:""}).width(),c=o.xOuter,l=o.yOuter,f=o.isEqual,p="none"!=i.css("display")?i.width():i.parent().width();if(0!==c){n=f?r.length:o.length>0?o.length:parseInt((p-2*c)/u);var h=(p-(n+1)*s-2*c-n*(parseFloat(r.css("padding-left"))+parseFloat(r.css("padding-right"))+parseFloat(r.css("border-left-width"))+parseFloat(r.css("border-right-width"))))/n;if(h<u)return;e(),i.css("padding-left",c)}if(0===c){n=f?r.length:o.length>0?o.length:parseInt(p/u);var h=(p-(n-1)*s-n*(parseFloat(r.css("padding-left"))+parseFloat(r.css("padding-right"))+parseFloat(r.css("border-left-width"))+parseFloat(r.css("border-right-width"))))/n;if(h<u)return;e(),function(){r.each(function(t,e){t%n==0&&$(e).css("margin-left",0)})}()}if(" "===c){n=f?r.length:o.length>0?o.length:parseInt(p/u);var h=(p-(n+1)*s-n*(parseFloat(r.css("padding-left"))+parseFloat(r.css("padding-right"))+parseFloat(r.css("border-left-width"))+parseFloat(r.css("border-right-width"))))/n;if(h<u)return;e()}0!=l&&(i.css("padding-bottom",d+l),i.css("padding-top",l)),0===l&&function(){var t=[1];r.each(function(e,a){for(var o=0;o<t.length;o++)e>=n*(t[o]-1)&&e<n*t[o]&&$(a).css("margin-top",0)})}()," "===l&&i.css("padding-bottom",d),r.css("width",h)},autoQuene:function(t){function e(){u.css("overflow","hidden");var t=u.find("a img");t.css({width:"100%",height:"auto"}),t.each(function(t,e){jQuery(e).parentsUntil("li").css({width:"auto",height:"auto"})}),(c.css("margin-right")||c.css("margin-bottom"))&&c.css({"margin-right":0,"margin-bottom":0}),c.css("margin-top",l),c.css("margin-left",l)}function a(){var t;return d.numForce>0?(s=d.numForce,t=(p-(s-1)*l-s*g)/s):h<=m?(s=h,t=(p-(s-1)*l-s*g)/s):h%m==0?(s=m,t=(p-(s-1)*l-s*g)/s):h%(m-1)==0?(s=m-1,t=(p-(s-1)*l-s*g)/s):(s=parseInt(p/f),t=(p-(s-1)*l-s*g)/s),t}function n(t){if("decorate"===jQuery("#pageType").val()){var e='<span id="J-module-size" style="position:absolute; z-index:10; top:27px; left:0; padding:5px 15px; background:rgba(0,0,0,.8); color:#fff;">当前模块宽度：'+u.width()+"px， 高度："+u.height()+"px"+t+"</span>";u.hover(function(){u.find("#J-module-size").remove(),u.append(e)},function(){u.find("#J-module-size").remove()})}}function o(){var t=u.attr("data-function")?u.attr("data-function"):0;0==t&&u.attr("data-function","autoQuene"),t.length>0&&-1==t.indexOf("autoQuene")&&u.attr("data-function",t+"autoQuene")}function i(){c.each(function(t,e){t%s==0&&$(e).css("margin-left",0)})}function r(){var t=[1];c.each(function(e,a){for(var n=0;n<t.length;n++)e>=s*(t[n]-1)&&e<s*t[n]&&$(a).css("margin-top",0)})}var s,d=$.extend({autoQueneNode:"li",margin:10,goodsTheoryWidth:190,numForce:0,message:""},t||{}),u=$(this),c=u.find(d.autoQueneNode),l=parseInt(d.margin),f=c.css({width:""}).width(),p="none"!=u.css("display")?u.width():u.parent().width(),h=c.length,m=parseInt(p/d.goodsTheoryWidth),g=parseFloat(c.css("padding-left"))+parseFloat(c.css("padding-right"))+parseFloat(c.css("border-left-width"))+parseFloat(c.css("border-right-width"));0!=h&&function(){var t=a();t>0&&(e(),i(),r(),c.css("width",t),setTimeout(function(){n(d.message)},500),o())}()},autoCenter:function(t){function e(){var t=o.width()-a.width();t>0?o.css({"margin-left":-t/2}):o.css("margin","0 auto")}var a=$(this),n=$.extend({autoMiddleNode:".userDefinedArea",isOwnLink:!0},t||{}),o=a.find(n.autoMiddleNode),i=n.isOwnLink;if(e(),$(window).resize(function(){e()}),i&&-1!=location.href.indexOf("visualEditing")){o.find("img").each(function(t,e){if("A"!=jQuery(e).parent()[0].tagName&&!jQuery(e).attr("usemap")){var a=jQuery(jQuery(e)[0].offsetParent);if(a.length&&jQuery(e).length){var n=jQuery(e).offset().top-a.offset().top+jQuery(e).height()/2-11,i=jQuery(e).width()/2-31;o.append('<img src="//img11.360buyimg.com/cms/jfs/t2353/241/73326232/691/b8435b2b/55ed2da1N0a73abac.png" width="62" height="23" style="position:absolute; left:'+i+"px; top:"+n+'px;" />')}}})}},tabClass:function(t){var e=$.extend({node:"li",defaultClass:"current"},t),a=$(this).find(e.node),n=e.defaultClass,o=e.defaultShow;o&&a.eq(o).addClass(n),a.bind({mouseenter:function(){$(this).addClass(n).siblings().removeClass(n)},mouseleave:function(){$(this).removeClass(n)}})},equallyWidth:function(t){var e=$.extend({equallyNode:".jSortTab span",equallyParentNode:null},t),a=$(this),n=a.find(e.equallyParentNode).length>0?a.find(e.equallyParentNode):a,o=a.find(e.equallyNode),i=o.eq(0),r=parseInt(i.data("outerWidth")||i.outerWidth(!0)),s=parseInt(i.data("width")||i.css("width")),d=o.length;i.data({outerWidth:r,width:s});var u=r-s,c=(n.width()-u*d-.03)/d;o.css({width:c})},changePhoto:function(t){var e=$.extend({changePhotoNode:".jPic img",smallPhoto:".jScrollWrap li",title:".jDesc a",defaultClass:"jCurrent",eventType:"click"},t||{}),a=$(this),n=a.find(e.changePhotoNode),o=a.find(e.smallPhoto),i=a.find(e.title);n.attr("src",o.eq(0).attr("data-src")),n.parent().attr("href",o.eq(0).attr("data-href")),i.attr("href",o.eq(0).attr("data-href")),o.eq(0).addClass(e.defaultClass),o[e.eventType](function(){var t=this;n.attr("src",$(t).attr("data-src")),n.parent().attr("href",$(t).attr("data-href")),i.attr("href",$(t).attr("data-href")),$(t).addClass(e.defaultClass).siblings().removeClass(e.defaultClass)})},movePhoto:function(t){var e=$.extend({movePhotoNode:".jScrollWrap li",arrowPrev:".jScrollPrev",arrowNext:".jScrollNext",defaultClass:"disabled"},t||{}),a=$(this),n=a.find(e.movePhotoNode),o=a.find(e.arrowPrev),i=a.find(e.arrowNext),r=parseInt(n.parent().parent().width()/n.width()),s=0,d=n.length;d>r&&(o.addClass(e.defaultClass).show(),i.show(),n.parent().css("width",n.width()*d)),i.click(function(){var t=this;d-r&&o.removeClass(e.defaultClass),s<d-r&&(s++,n.parent().animate({left:-n.eq(0).outerWidth(!0)*s},function(){s+r==d&&$(t).addClass(e.defaultClass)}))}),o.click(function(){var t=this;s+r<=d&&i.removeClass(e.defaultClass),s>0&&(s--,n.parent().animate({left:-n.eq(0).outerWidth(!0)*s},function(){s||$(t).addClass(e.defaultClass)}))})},hideNode:function(t){var e=$.extend({currentNode:".jLeftPic",changeNode:".jMiddlePic",defaultClass:"jCurrent",enterTime:200,leaveTime:100},t||{}),a=$(this),n=a.find(e.currentNode),o=a.find(e.changeNode);e.enterTime<0||e.leaveTime<0||(n.mouseenter(function(){o.animate({opacity:0},e.enterTime,function(){o.addClass(e.defaultClass)})}),n.mouseleave(function(){o.removeClass(e.defaultClass),o.animate({opacity:1},e.leaveTime,function(){})}))},fullHeight:function(t){var e,a=$.extend({fullHeightNode:"li",fullNode:".jShade"},t),n=$(this).find(a.fullHeightNode);n.bind({mouseenter:function(){e=$(this).find(a.fullNode),e.css({height:$(this).height()})}})},ridLazy:function(t){$(t).find("img.J_imgLazyload").each(function(){$(this).attr("src",$(this).attr("original")),$(this).removeAttr("original"),$(this).removeClass("J_imgLazyload")});var e=e||{};setTimeout(function(){"function"==typeof e.localPriceRefresh&&e.localPriceRefresh(t)},0)},rid:function(){jshop.module.ridLazy(this)},middle:function(t){var e=$.browser.msie&&"6.0"==$.browser.version,a=e?"absolute":"fixed",n=$(window).width(),o=$(window).height();return $(t).css({left:parseInt((n-$(t).outerWidth())/2)+"px",top:parseInt((o-$(t).outerHeight())/2)+(this.bIsIE6?$(window).scrollTop():0)+"px",position:a}),t},positionLayout:function(t){var e=this,a=$.extend({node:".btn-coll",nodeParent:".d-layout"},t),n=$(e).find(a.node),o=$(e).parents(a.nodeParent);o.css({position:"relative"}),n.appendTo(o).siblings(a.node).remove()},notity:function(t){var e=$.extend({notityNode:".jshop_jiangjia"},t||{}),a=this;NotifyPop.init=function(t,e){var a,n=this,o=this.serializeUrl(location.href),i=/from=weibo/.test(location.href)?location.search.replace(/\?/,""):"";/from=weibo/.test(location.href)&&(a=o.param.type,this.setThickBox(a,i)),t.bind("click",function(){var t=($(this).attr("id"),$(this).attr("data-type")||2);return n.sku=$(this).attr("data-sku"),n.checkLogin(function(e){e.IsAuthenticated?(n._userPin=e.Name,n.setThickBox(t,i)):thick_login(function(e){n._userPin=e.Identity.Name,n.setThickBox(t,i)})}),!1}).attr("href","#none").removeAttr("target")},$(a).find(e.notityNode).each(function(t,e){NotifyPop.init($(e))})},tab:function(t){var e=$.extend({tabNode:".jSortTab span",arrow:".jSortTabArrow",defaultClass:"current",tabContent:".jSortContent ul",isNeedWidth:!0,eventType:"mouseenter"},t),a=this,n=$(a).find(e.tabNode),o=$(a).find(e.tabContent),i=$(a).find(e.arrow),r=0,s=!0;n.eq(0).addClass(e.defaultClass),o.eq(0).addClass(e.defaultClass).data("lazyload",!0);var d=(n.parent().parent().width()-.03)/n.length;e.isNeedWidth&&n.css({width:d}),i.css({width:d}),n.each(function(t,a){$(a)[e.eventType](function(){r=t,s&&(s=!1,$(this).addClass(e.defaultClass).siblings().removeClass(e.defaultClass),o.eq(r).addClass(e.defaultClass).siblings().removeClass(e.defaultClass),i.length?i.animate({left:r*d},300,function(){s=!0,r!=t&&n.eq(r).trigger(e.eventType)}):(s=!0,r!=t&&n.eq(r).trigger(e.eventType))),o.eq(r).data("lazyload")||jshop.module.ridLazy(o.eq(r).data("lazyload",!0))})})},funcTab:function(t){var e={tabNode:".jSortTab span",defaultClass:"current",tabContent:".jSortContent ul",eventType:"click"},a=$.extend(e,t),n=$(this).find(a.tabNode),o=$(a.tabContent);if($(".pc_func_module_invisible").length){var i=!0,r=n.eq(0).attr("funcLayoutIds").split(",");$.map(r,function(t){o.find("#"+t).parent().show().addClass("func-module-init").attr("funcompleted",!0),o.find("#"+t).parent().addClass(a.defaultClass).data("lazyload",!0),setTimeout(function(){moduleRefresh.call($("#"+t),"funcParam")},50)}),n.unbind(a.eventType).bind(a.eventType,function(){if(i){i=!1,$(this).addClass(a.defaultClass).siblings().removeClass(a.defaultClass);var t=$(this).attr("funcLayoutIds").split(",");$(".d-layout-area.pc_func_module_invisible").hide(),$.map(t,function(t){$("#"+t).parent().show(10,function(){$("#"+t).parent().attr("funcompleted")||(moduleRefresh.call($("#"+t),"funcParam"),$("#"+t).parent().attr("funcompleted",!0)),$("#"+t).parent().data("lazyload")||jshop.module.ridLazy($("#"+t).parent().data("lazyload",!0))})}),i=!0}})}},tabShow:function(t){function e(){i.eq(d).addClass(r).siblings().removeClass(r),i.animate({opacity:0},0,function(){}),i.eq(d).animate({opacity:1},a.tabTime,function(){})}var a=$.extend({eventNode:".jClick",parentNode:".jSortContent",childNode:"ul",defaultClass:"current",eventType:"click",num:0,tabTime:500,subFunction:"circle"},t),n=$(this),o=n.find(a.eventNode),i=(n.find(a.parentNode),n.find(a.childNode)),r=a.defaultClass,s=a.eventType,d=a.num===Number&&a.num<=u?a.num:0,u=(a.tabTime,a.subFunction,i.length),c=!0;i.eq(d).addClass(r),o[s](function(){a.subFunction&&l[a.subFunction].call(n),e()});var l={circle:function(){d=(d+1)%u},direction:function(){c?++d==u-1&&(c=!1):0==--d&&(c=!0)},random:function(){d=parseInt(Math.random()*u)}}},slide:function(t){function e(){h.css({width:m.attr("width"),height:m.attr("height")}),m.eq(0).addClass(y),v.eq(0).addClass(y),a(),$(window).resize(function(){a()})}function a(){var t=h.width()-$(f).width();t>0?h.css({"margin-left":-t/2}):h.css("margin","0 auto")}function n(){v.each(function(t,e){$(e)[j](function(){return m.eq(I).removeClass(y),v.eq(I).removeClass(y),I=t,m.eq(I).addClass(y),v.eq(I).addClass(y),Q(),!1})})}function o(){clearTimeout(N),N=null,w.clearQueue(),m.eq(I).clearQueue()}function i(){p.isCircular?I<m.length-1?c([m,v],y,!0):(I=-1,c([m,v],y,!0)):1==b?I<m.length-1?c([m,v],y,!0):(b=0,c([m,v],y,!1)):I>0?c([m,v],y,!1):(b=1,c([m,v],y,!0)),Q()}function r(){var t=$(f).find(p.arrowLeft),e=$(f).find(p.arrowRight);$(f).bind({mouseover:function(){t.show(),e.show()},mouseout:function(){t.hide(),e.hide()}})}function s(){var t=$(f).find(p.arrowLeft),e=$(f).find(p.arrowRight),a=p.arrowLeftOver,n=p.arrowRightOver;t.bind({click:function(){return 0!=I?(c([m,v],y,!1),Q()):p.isCircular&&(c([m,v],y,!1),I=m.length,c([m,v],y,!1),Q()),!1},mouseover:function(){$(this).addClass(a)},mouseout:function(){$(this).removeClass(a)}}),e.bind({click:function(){return I<m.length-1?(c([m,v],y,!0),Q()):p.isCircular&&(I=-1,c([m,v],y,!0),Q()),!1},mouseover:function(){$(this).addClass(n)},mouseout:function(){$(this).removeClass(n)}})}function d(){m.animate({opacity:0},0,function(){}),$(f).css({"background-color":m.eq(I).attr("background")}),m.eq(I).animate({opacity:1},1e3,function(){o(),S||(N=setTimeout(i,k))})}function u(){var t=I*x-h[0][l],e=t>0?Math.ceil(t/10):Math.floor(t/10);h[0][l]+=e,0==e?(m.eq(I).addClass(y),v.eq(I).addClass(y),e=null,o(),S||(N=setTimeout(i,k))):T=setTimeout(u,30),$(f).css({"background-color":m.eq(I).attr("background")})}function c(t,e,a){t.each(function(t,a){a.eq(I).removeClass(e)}),a?I++:I--,t.each(function(t,a){a.eq(I).addClass(e)})}var l,f=this,p=$.extend({imgArea:".jbannerImg",imgNodeArea:".jImgNodeArea",imgNode:".jbannerImg li",tabArea:".jbannerTab",tabNode:".jbannerTab span",arrowLeft:".jPreOut",arrowRight:".jNextOut",arrowLeftOver:"jPreOver",arrowRightOver:"jNextOver",defaultClass:"show",slideDirection:"left",timer:"3",subFunction:"transparentEffect",eventType:"click",showArrow:1,tabAreaHoverStop:!1,isCircular:!1,isTabAvailable:!0,isHoverStop:!0},t),h=$(f).find(p.imgArea),m=$(f).find(p.imgNode),g=$(f).find(p.tabArea),v=$(f).find(p.tabNode),y=p.defaultClass,j=p.eventType,k=1e3*!p.timer?3e3:1e3*p.timer,w=$(f).find(p.imgNodeArea+">ul"),C=$(f).find(p.imgNodeArea),I=(p.isFull,0),b=1,N=null,x=0,T=null,Q=null,S=!1;if(m.length){jshop.module.ridLazy($(f)),p.isHoverStop&&h.bind({mouseenter:function(){S=!0,o()},mouseleave:function(){S=!1,N=setTimeout(i,k)}}),p.tabAreaHoverStop&&g.bind({mouseenter:function(){S=!0,o()},mouseleave:function(){S=!1,N=setTimeout(i,k)}});var A={transparentEffect:function(){$(f).css({"background-color":m.eq(I).attr("background")}),e(),p.isTabAvailable&&n(),s(),1!=p.showArrow&&r(),Q=d,N=setTimeout(i,k)},moveEffect:function(){var t="top"==p.slideDirection;l=t?"scrollTop":"scrollLeft",$(f).css({"background-color":m.eq(I).attr("background")}),t?(C.css({height:2e4}),m.css({width:m.attr("width"),height:m.attr("height")}),x=m.height(),h[0][l]=I*x):(C.css({width:2e4}),m.css({width:m.attr("width"),height:m.attr("height"),"float":"left"}),x=m.width(),h[0][l]=I*x),e(),p.isTabAvailable&&n(),s(),1!=p.showArrow&&r(),Q=u,N=setTimeout(i,k)}};A[p.subFunction]&&A[p.subFunction].call(f)}},operateNode:function(t){var e=$.extend({operateNode:"li",operateParentNode:null,defaultClass:"jCurrent",length:0,subFunction:null,number:[],callBack:null},t||{}),a=$(this),n=a.find(e.operateNode),o=a.find(e.operateParentNode).length>0?a.find(e.operateParentNode):a.parent().parent().parent(),i=e.defaultClass,r=e.number,s=0!=e.length?e.length:parseInt(o.outerWidth(!0)/n.outerWidth(!0)),d="function"==typeof e.callBack?e.callBack:function(t){t.addClass(i)};if(0!==n.length){var u=0,c=$(n[0]).offset().top;n.each(function(t,e){if(t>0){u++;var a=$(e).offset().top;if(c!==a)return!1;c=a}});var l={getNode:function(){return n.map(function(t,e){for(var a=0;a<r.length;a++)if(t+1===r[a])return e})},getAllOdd:function(){return n.map(function(t,e){if(t%2==0)return e})},getAllEven:function(){return n.map(function(t,e){if(t%2==1)return e})},getColumn:function(){return n.map(function(t,e){for(var a=0;a<r.length;a++)if(t%s==r[a]-1)return e})},getRow:function(){return n.map(function(t,e){for(var a=0;a<r.length;a++)if(t>=s*(r[a]-1)&&t<s*r[a])return e})},getRowOdd:function(){return n.map(function(t,e){if(t%s%2==0)return e})},getRowEven:function(){return n.map(function(t,e){if(t%s%2==1)return e})},getFirst:function(){return n.eq(0)},getLast:function(){return n.eq(n.length-1)},getRowFirst:function(){return n.map(function(t,e){if(t%s==0)return e})},getRowLast:function(){return n.map(function(t,e){if(t%s==s-1)return e})},getRowFirstAndLast:function(){return n.map(function(t,e){if(t%s==0||t%s==s-1)return e})}};l[e.subFunction]&&d(l[e.subFunction]())}},showNode:function(t){function e(){o.removeClass(n.className);for(var t=r*n.pageNum;t<=r*n.pageNum+n.pageNum-1;t+=1)o.eq(t).addClass(n.className)}var a=this,n=jQuery.extend({par:".jSaleAttention20150423-1",node:"li",btn:".jBtn",pageNum:10,className:"current"},t||{}),o=(jQuery(n.par),jQuery(a).find(n.node)),i=jQuery(a).find(n.btn),r=0,s=Math.ceil(o.length/n.pageNum);e(),i.click(function(){r+1==s?r=0:r+=1,e()})},countdown:function(){var t=null,e=[],a=0,n=0;return function(o){function i(){n=1;var t=INTERFACE.actJshop.serverTime;$.ajax({url:t,type:"GET",cache:!1,dataType:"jsonp",success:function(t){if(n=0,t.nowTime){var e=t.nowTime?new Date(t.nowTime):new Date;a=new Date-e,n=1}},error:function(t){n=0}})}function r(t){for(var e=t.split(" "),a=e[0].split("-"),n=e[1].split(":");n.length<3;)n.push(0);return new Date(Number(a[0]),(Number(a[1])+11)%12,Number(a[2]),Number(n[0]),Number(n[1]),Number(n[2]))}function s(){var t=c.countdownInfo;t.constructor==String?l.push(r(t)):$.each(t,function(t,e){l.push(r(e))})}function d(){t=setInterval(function(){0==n&&i();for(var t=0,o=e.length;t<o;t++){var r=$(e[t]),s=r.data("cutTime"),d=r.data("arg");if(s&&!(s.length<1)){var u=parseInt((s[0]-new Date+a)/1e3);if(u<0)s.shift(),0===s.length?(e.splice(t,1),o--,t--):r.data("cutTime",s),r.closest("[module-name]").trigger("countdownchange");else{var c=Math.floor(u/86400),l=Math.floor(u/3600)-(d.hasDay?24*c:0),f=Math.floor(u%3600/60),p=u%60;d.hasDay&&r.find(d.dayCnt).html(c>9?c:"0"+c),r.find(d.hourCnt).html(l>9?l:"0"+l),r.find(d.minuteCnt).html(f>9?f:"0"+f),r.find(d.secondCnt).html(p>9?p:"0"+p)}}}},1e3)}var u=this,c=$.extend({hasDay:!0,dayCnt:".days",hourCnt:".hours",minuteCnt:".minutes",secondCnt:".seconds"},o||{}),l=[];!function(){c.countdownInfo&&(s(),$(u).data("cutTime",l).data("arg",c),setTimeout(function(){e=$('[module-function*="countdown"]').toArray()},0),0==n&&i(),d())}()}}(),countdownHasSysTime:function(){var t=null,e=[],a=0;return function(n){function o(){var t=new Date(s.serverTime);a=new Date-t}function i(){t=setInterval(function(){var t=$(r),e=parseInt((d-new Date+a)/1e3);if(e<0)t.closest("[module-name]").trigger("countdownchange");else{var n=Math.floor(e/86400),o=Math.floor(e/3600)-(s.hasDay?24*n:0),i=Math.floor(e%3600/60),u=e%60;s.hasDay&&t.find(s.dayCnt).html(n>9?n:"0"+n),t.find(s.hourCnt).html(o>9?o:"0"+o),t.find(s.minuteCnt).html(i>9?i:"0"+i),t.find(s.secondCnt).html(u>9?u:"0"+u)}},1e3)}var r=this,s=$.extend({hasDay:!0,dayCnt:".days",hourCnt:".hours",minuteCnt:".minutes",secondCnt:".seconds",serverTime:""},n||{}),d=[],d=new Date(s.countdownInfo);!function(){s.countdownInfo&&(e=$(r).toArray(),o(),i())}()}}(),loop:function(t){function e(){s.css({overflow:"hidden",position:"relative"}),i.find(r.item).css("float","left")}function a(){var t=s.html(),e=r.height||s.height();i.find(r.item).remove(),s.height(e),p=$("<div></div>").prependTo(s).css({width:(u+2*f)*d,height:e,position:"absolute",left:0,top:0}).html(t),r.conCls&&p.addClass(r.conCls);for(var a=i.find(r.item),n=u-1,o=u-f;n>=o;n--)a.eq(n).clone(!0).prependTo(p);for(var n=0;n<f;n++)a.eq(n).clone(!0).appendTo(p);p.css("left",-f*d)}function n(){i.find(r.next).click(function(){c||(c=!0,l+=f,p.animate({left:-l*d},h,function(){l>=u+f&&(l-=u,p.css("left",-l*d)),c=!1}))}),i.find(r.prev).click(function(){c||(c=!0,l-=f,p.animate({left:-l*d},h,function(){l<f&&(l+=u,p.css("left",-l*d)),c=!1}))}),r.eventType&&i.find(r.item).each(function(t,e){$(e)[r.eventType](function(){r.handle(e,t,f)})})}var o=this,i=$(o),r=$.extend({auto:!1,next:".next",prev:".prev",container:".con",item:".item"},t),s=i.find(r.container),d=0,u=0,c=!1,l=0,f=1,p=null,h=r.duration||1e3;!function(){e(),i.find(r.item).length&&(f=Math.ceil(s.width()/i.find(r.item).outerWidth(!0)),d=i.find(r.item).outerWidth(!0),u=i.find(r.item).length,l=f,i.find(r.item).length<f||(a(),n()))}()},hoverAnimate:function(t){var e=$.extend({node:"li .jItem",cssValueOne:[{width:235,height:365,marginTop:-10,opacity:1},{width:235,height:355,marginTop:-5,opacity:.9},{width:235,height:365,marginTop:-10,opacity:1}],cssValueTwo:[{width:235,height:345,marginTop:0,opacity:1}],timerOne:100,timerTwo:100},t||{}),a=$(this),n=a.find(e.node),o=e.cssValueOne,i=e.cssValueTwo;n.bind({mouseenter:function(){var t=o.length,a=0,n=$(this);!function(){var i=arguments.callee;n.animate(o[a],e.timerOne,function(){++a!=t&&i()})}()},mouseleave:function(){var t=i.length,a=0,n=$(this);n.stop(!0),function(){var o=arguments.callee;n.animate(i[a],e.timerTwo,function(){++a!=t&&o()})}()}})},getProTag:function(t){var e=$.extend({node:"li",tagNode:".jSlogan",tagValue:{3:"赠券",4:"赠京豆",5:"赠品",11:"会员特价",22:"京豆优惠购",55:"满减",58:"满赠",57:"加价购",59:"多买优惠"},dataNum:40,url:INTERFACE.promoTag+"?callback=getPromotionTag&skuids=J_981821,J_1057746",urlNum:26},t),a=$(this),n=a.find(e.node);n.length&&function(){var t=[];n.each(function(e,a){t.push("J_"+$(a).attr("skuid"))});for(var o=Math.ceil(t.length/e.dataNum),i=0;i<o;i++){var r=t.slice(i*e.dataNum,Math.min(t.length,(i+1)*e.dataNum));$.ajax({url:e.url.substr(0,e.urlNum),data:{skuids:r.join(","),source:"JSHOP"},dataType:"jsonp",success:function(t){$.each(t,function(t,n){for(var o="",i=0;i<n.pf.length;i++)e.tagValue[n.pf[i]]&&(o+="<span>"+e.tagValue[n.pf[i]]+"</span>");a.find(e.node+"[skuid="+n.pid+"]").find(e.tagNode).html(o)})}})}}()},getAdWords:function(t){var e=$.extend({node:"li",tagNode:".jSlogan",dataNum:40,url:INTERFACE.adWords},t),a=$(this),n=a.find(e.node);n.length&&function(){var t=[];n.each(function(e,a){t.push("AD_"+$(a).attr("skuid"))});for(var o=Math.ceil(t.length/e.dataNum),i=0;i<o;i++){var r=t.slice(i*e.dataNum,Math.min(t.length,(i+1)*e.dataNum));$.ajax({url:e.url,data:{skuids:r.join(","),source:"JSHOP"},dataType:"jsonp",success:function(t){$.each(t,function(t,n){var o="";o+="<span>"+n.ad+"</span>",a.find(e.node+"[skuid="+n.id.substr(3,n.id.length)+"]").find(e.tagNode).html(o)})}})}}()},moveNode:function(t){var e=$.extend({moveNode:".scroll-area li",arrowPrev:".arrow-left",arrowNext:".arrow-right",disabled:"disabled",showNum:"",cssValue:"margin-left",isLoop:!0,isScreen:!0,timer:1},t||{}),a=$(this),n=a.find(e.moveNode),o=a.find(e.arrowPrev),i=a.find(e.arrowNext),r=e.showNum>0?parseInt(e.showNum):Math.ceil(n.parent().parent().width()/n.outerWidth(!0)),s=0,d=e.isScreen?Math.ceil(n.length/r):n.length,u=!0,c=e.isScreen?r*n.eq(0).outerWidth(!0):n.eq(0).outerWidth(!0),l=e.isScreen?1:r,f=e.timer>-1&&e.timer<5?1e3*e.timer:1e3;d>l&&(o.show().addClass(e.disabled),i.show(),n.parent().css("width",c*d*10),e.isLoop&&function(){for(var t=0;t<r;t++)n.eq(t).clone().appendTo(n.parent()),n.eq(n.length-1-t).clone().prependTo(n.parent());n.parent().css(e.cssValue,-c*l+parseInt(n.parent().css(e.cssValue)))}());var p={};n.parent().data("cssInitValue",parseInt(n.parent().css(e.cssValue))),i.click(function(){e.isLoop||0==s&&(u=!0),u&&(u=!1,s++,p[e.cssValue]=-c*s+n.parent().data("cssInitValue"),n.parent().animate(p,f,function(){u=!0,e.isLoop?s==d&&(s=0,n.parent().css(e.cssValue,n.parent().data("cssInitValue"))):(s>0&&o.removeClass(e.disabled),s+l==d&&(i.addClass(e.disabled),u=!1))}))}),o.click(function(){e.isLoop||(u=s>0),u&&(u=!1,s--,p[e.cssValue]=-c*s+n.parent().data("cssInitValue"),n.parent().animate(p,f,function(){u=!0,e.isLoop?s<0&&(s=d-1,n.parent().css(e.cssValue,n.parent().data("cssInitValue")+-c*s)):(s<d-1&&i.removeClass(e.disabled),0==s&&(o.addClass(e.disabled),u=!1))}))})},addToCart:function(t){var e=$.extend({node:"li",img:".jPic img",cart:".jBtnArea a",property:"data-sku",jdCart:"#settleup-2013",cartNum:"#shopping-amount",timer:500},t||{}),a=$(this),n=a.find(e.node),o=$(e.jdCart),i=o.find(e.cartNum);n.each(function(t,a){var n=$(a).find(e.img),s=$(a).find(e.cart);s.click(function(){r.add(s,$(a).attr(e.property),n,o,i,e.timer)})});var r={ele:null,sku:null,ptype:null,pcount:null,add:function(t,e,a,n,o,i,r,s){
0!=e&&(this.ele=t,this.sku=e,this.ptype=s||1,this.pcount=r||1,this.img=a,this.jdCart=n,this.cartNum=o,this.timer=i,this.versonAnimate())},versonAnimate:function(){var t=this;clearTimeout(t.timer),t.timer=null,this.addToCart();var e=t.img,a=e.height(),n=e.width(),o=e.offset().left,i=e.offset().top,r=($(document).scrollTop(),t.jdCart.offset().left+50),s=t.jdCart.offset().top,d=$('<div class="flyGoods jGoodsRecommend20140909" style="position:absolute;z-index: 10;"></div>'),u=$(t.ele);d.html(e.clone()).css({left:o+n/2-25+Math.round(40*Math.random()+0-20),top:i+a/2-1+Math.round(40*Math.random()+0-20)}),d.appendTo("body"),d.animate({top:u.offset().top,left:u.offset().left+u.width()-50},t.timer,"easeOutCirc",function(){d.animate({left:r,top:s,opacity:.1},t.timer,"easeInOutQuint",function(){t.getCartNum(),d.remove()})})},addToCart:function(){var t=INTERFACE.reBuyForOrderCenter+"?wids={PID}&nums={PCOUNT}";t=t.replace("{PID}",this.sku).replace("{PCOUNT}",this.pcount).replace("{PTYPE}",this.ptype),jQuery.ajax({url:t,dataType:"jsonp"})},getCartNum:function(){var t=this;jQuery.ajax({url:INTERFACE.miniCartServiceNew,data:{method:"GetCart"},dataType:"jsonp",success:function(e){try{t.cartNum.html(e.Cart.Num)}catch(t){}}})}}},estimation:function(t){var e=$.extend({skuNode:"li",starNode:".j-star",rateNote:".j-rate",countNode:".j-count",commentNode:".j-comment",skuName:"skuid"},t),a=$(this),n=a.find(e.skuNode),o=[];if(0!==n.length){n.each(function(t,a){o.push(a.getAttribute(e.skuName))});for(var i=0;i<o.length;i+=10)$.ajax({url:INTERFACE.actJshop.recommend,type:"GET",dataType:"jsonp",data:{type:0,skuIds:o.slice(i,i+10).join(",")},success:function(t){if(t&&t.length>0)for(var n=0;n<t.length;n++){var o=a.find(e.skuNode+"["+e.skuName+"='"+t[n].skuId+"']"),i="";o.find(e.rateNote).text(1e4*t[n].rate/100),o.find(e.countNode).text(t[n].count),o.find(e.commentNode).text(t[n].comment).attr("title",t[n].comment),i=t[n].rate>=.95?"star5":t[n].rate>=.9&&t[n].rate<.95?"star4":t[n].rate>=.85&&t[n].rate<.9?"star3":t[n].rate>=.8&&t[n].rate<.85?"star2":t[n].rate>=.75&&t[n].rate<.8?"star1":"star0",o.find(e.starNode).addClass(i)}}})}},goodsFollow:function(t){var e=this,a=$.extend({node:".J-follow",showNum:".J-follow-num"},t);$(e).find(a.node).JFollow(a)},goodsShare:function(t){var e=this,a=$.extend({node:".J-share",eventType:"mouseover",offset:{top:0,left:0}},t);$(e).find(a.node).JShare({eventType:a.eventType,offset:a.offset})},marqueeLeft:function(t){function e(){r.offsetWidth-o.scrollLeft<=0?o.scrollLeft-=r.offsetWidth:o.scrollLeft++}var a=$.extend({node:".scroll-area",tr:"tr",td:"td",speed:20},t||{}),n=$(this),o=n.find(a.node)[0],i=$(o).find("tr")[0],r=$(o).find("td")[0];if(r.offsetWidth>=o.offsetWidth){!function(){var t=document.createElement("td");t.innerHTML=r.innerHTML,i.appendChild(t)}();var s=setInterval(e,a.speed);o.onmouseover=function(){clearInterval(s)},o.onmouseout=function(){s=setInterval(e,a.speed)}}},seamlessScroll:function(t){var t=jQuery.extend({box:jQuery(".marquee"),step:5,el:"ul",itemClass:".item",inteval:30},t||{});new SeamlessScroll(t).init()},brandAttent:function(t){function e(){if(0==r.attr(s.dataState))return void(1==dataType&&r.html("关注品牌"));jQuery("body").append(l,f);var t=jQuery(".follow-dialog"),e=jQuery(".follow-dialog-mask"),a=t.find(".attent-con"),n=t.find(".attent-msg"),o=t.find(".attent-other"),i=t.find(".attent-close"),d=jQuery("#followCls");1==r.attr(s.dataState)&&(1==dataType&&r.html("已关注"),n.html(p.brand.msgOk),o.html(p.brand.msgOther),a.addClass("attent-ok"),t.addClass("current"),e.addClass("current")),2==r.attr(s.dataState)&&(n.html(p.brand.msgRepeat),o.html(p.brand.msgOther),a.addClass("attent-repeat"),t.addClass("current"),e.addClass("current")),3==r.attr(s.dataState)&&(n.html(p.brand.msgMax),o.html(p.brand.msgOther),a.addClass("attent-repeat"),t.addClass("current"),e.addClass("current")),4==r.attr(s.dataState)&&(n.html(p.brand.msgError),o.html(p.brand.msgOther),a.addClass("attent-error"),t.addClass("current"),e.addClass("current")),i.click(function(){t.remove(),e.remove(),d.remove()})}function a(){u.mouseenter(function(){var t=jQuery(this).attr(s.dataState),e=jQuery(this).attr(s.dataType);1!=t&&2!=t||0!=e&&jQuery(this).html("取消关注")}).mouseleave(function(){var t=jQuery(this).attr(s.dataState),e=jQuery(this).attr(s.dataType);1!=t&&2!=t||0!=e&&jQuery(this).html("已关注")}),u.click(function(){r=jQuery(this),c=[{activityId:r.attr(s.dataId)}],dataType=r.attr(s.dataType),0!=dataType&&(1==r.attr(s.dataState)||2==r.attr(s.dataState))?thick_login(i):thick_login(o)})}function n(){$.ajax({url:INTERFACE.brandFollow.batchIsFollow,data:{brandId:JSON.stringify(c),sysName:"sale.jd.com"},dataType:"jsonp",success:function(t){if("F10000"==t.code)for(var e=0,a=u.length;e<a;e+=1){var n=jQuery(u[e]),o=n.attr(s.dataId),i=n.attr(s.dataType);t.data[o]?(1==i&&n.html("已关注"),n.attr(s.dataState,1)):(1==i&&n.html("关注品牌"),n.attr(s.dataState,0))}}})}function o(){$.ajax({url:INTERFACE.brandFollow.batchfollow,data:{brandId:JSON.stringify(c),sysName:"sale.jd.com"},dataType:"jsonp",success:function(t){"F10000"==t.code?t.data&&(r.attr(s.dataState,1),e()):"F0402"==t.code?t.data||(r.attr(s.dataState,2),e()):"F0410"==t.code?(r.attr(s.dataState,3),e()):(r.attr(s.dataState,4),e())}})}function i(){$.ajax({url:INTERFACE.brandFollow.batchUnfollow,data:{brandId:JSON.stringify(c),sysName:"sale.jd.com"},dataType:"jsonp",success:function(t){"F10000"==t.code&&t.data&&(r.attr(s.dataState,0),e())}})}var r,s=jQuery.extend({node:".e-attention",pageIdValue:"#tb_id",dataId:"data-id",dataState:"data-state",dataType:"data-type"},t||{}),d=jQuery(this),u=d.find(s.node),c=[];if(u.length){var l='<div class="follow-dialog-mask"></div><div class="follow-dialog"><div class="attent-mt"><span class="attent-close" title="关闭">关闭</span><span class="attent-title">提示</span></div><div class="attent-mc"><div class="attent-con"><span class="attent-msg"></span><span class="attent-other"></span></div></div></div>',f='<style id="followCls">.follow-dialog-mask{position:fixed; _position:absolute; left:0; top:0; right:0; bottom:0; background:#000; opacity:0.3; filter:alpha(opacity=30); z-index:100; display:none;}.follow-dialog-mask.current{display:block;}.follow-dialog{width:310px; height:185px; /*border:solid 5px rgba(8,1,3,0.3);*/ border:solid 5px #ccc; background:#fff; position:fixed; _position:absolute; left:50%; top:50%; margin:-92px 0 0 -155px; z-index:101; display:none;}.follow-dialog.current{display:block;}.follow-dialog .attent-mt{height:32px; line-height:32px; background:#f5f5f5; font-size:16px; color:#222; text-indent:10px; overflow:hidden;}.follow-dialog .attent-close{float:right; width:32px; height:32px; text-indent:-9999px; background:url(//img10.360buyimg.com/cms/jfs/t1420/84/156758085/1080/d48a39fe/555e9e79N85386290.png) center center no-repeat; cursor:pointer;}.follow-dialog .attent-ok, .follow-dialog .attent-repeat, .follow-dialog .attent-error, .follow-dialog .attent-max{margin:48px 0 0 55px; height:40px; padding-left:48px;}.follow-dialog .attent-ok{background:url(//img12.360buyimg.com/cms/jfs/t1435/352/153421548/1347/d377c92d/555e9e71Nb767e906.png) left center no-repeat;}.follow-dialog .attent-repeat, .follow-dialog .attent-error, .follow-dialog .attent-max{background:url(//img14.360buyimg.com/cms/jfs/t1516/358/164942511/1418/e0c25f0c/555e9e75Nfca9da16.png) left center no-repeat;}.follow-dialog .attent-ok .attent-msg{font-size:14px; color:#009900; font-weight:bold;}.follow-dialog .attent-repeat .attent-msg, .follow-dialog .attent-error .attent-msg, .follow-dialog .attent-max .attent-msg{font-size:14px; color:#ff771e; font-weight:bold;}.follow-dialog .attent-other{color:#6f6363; display:block; margin-top:3px;}.follow-dialog .attent-other a{color:#004499;}.follow-dialog.attent-mall .attent-other a{margin:0 5px;}</style>',p={brand:{msgOk:"&#x5173;&#x6CE8;&#x54C1;&#x724C;&#x6210;&#x529F;",msgRepeat:"&#x5DF2;&#x7ECF;&#x5173;&#x6CE8;",msgError:"&#x5173;&#x6CE8;&#x54C1;&#x724C;&#x5931;&#x8D25;",msgMax:"&#x5173;&#x6CE8;&#x7684;&#x54C1;&#x724C;&#x8FBE;&#x5230;&#x6700;&#x5927;&#x6570;&#x91CF;",msgOther:'<a href="//t.jd.com/follow/brand/list.action" target="_blank">&#x67E5;&#x770B;&#x6211;&#x7684;&#x5173;&#x6CE8;>></a>'},mall:{msgOk:"&#x5173;&#x6CE8;&#x6210;&#x529F;",msgRepeat:"&#x5DF2;&#x7ECF;&#x5173;&#x6CE8;",msgError:"&#x5173;&#x6CE8;&#x5931;&#x8D25;",msgOther:'&#x67E5;&#x770B;&#x6211;&#x5173;&#x6CE8;&#x7684;<a href="//t.jd.com/vender/followVenderList.action" target="_blank">&#x5E97;&#x94FA;</a>&#x548C;<a href="//t.jd.com/follow/brand/list.action" target="_blank">&#x54C1;&#x724C;</a>'}};!function(){for(var t=0,e=u.length;t<e;t+=1)c.push({activityId:jQuery(u[t]).attr(s.dataId)})}(),function(){n(),a()}()}},saleAttent:function(t){jQuery(this).saleAttent(t)},getCoupon:function(t){jQuery(this).getCoupon(t)},createQrCode:function(t){function e(t){var e,n,o,i=t.find(a.qrCodeArea),s=i.find(a.qrCode);""===s.html()&&(n=i.attr(a.dataHref).replace(/ /g,""),a.activityId?(e=$("#"+a.activityId).val(),o=n+"&resourceType=Jshop_pc_scan&resourceValue=Jshop_"+e):o=n,new QRCode(s[0],{text:o,width:s.width(),height:s.height()}),i.removeAttr(a.dataHref)),t.addClass(r),i.mouseleave(function(){t.removeClass(r)})}var a=jQuery.extend({node:"li",iconQrCode:".iconQrCode",qrCodeArea:".jQrCode",dataHref:"qrHref",qrCode:".qrPic",qrcJsImport:"//static.360buyimg.com/static-sale-p/module/stable/qrcode/qrcode.js",current:"current"},t||{}),n=jQuery(this),o=(n.find(a.node),n.find(a.iconQrCode)),i=a.qrcJsImport,r=(a.eventType,n.find(a.close),a.current);isQrcJsImport="undefined"!=typeof isQrcJsImport&&isQrcJsImport,!1===isQrcJsImport&&(isQrcJsImport=!0,jQuery.getScript(i,function(){})),o.hover(function(){e(jQuery(this).closest(a.node))},function(){})},getDivinerGoods:function(t){function e(t){if(t.data){o.attr("data-impr",t.impr);var e=o.html(),n="";if(e.length){for(var i=a.startLim,r=t.data.length||0;i<r;i++)t.data[i].bn&&!/\/\//.test(t.data[i].bn)&&(t.data[i].bn="//img30.360buyimg.com/jgsq-productsoa/"+t.data[i].bn),n+=jshop.module.renderHTML(e,t.data[i]);o.html(n).addClass(a.current)}}}var a=jQuery.extend({isScreenNode:"ul",nodeParent:"#J_hotListWrap",nodeCon:"ul",domNode:"li",attentNode:".e-attention",url:INTERFACE.diviner,p:619044,lim:8,startLim:0,current:"current",timeout:500,pageUrl:"",staticHtml:".staticHtml"},t),n=jQuery(this),o=(jQuery(a.nodeParent),n.find(a.nodeCon));o.length&&function(){var t=getUrlArg(location.href);if(t)var i=t.brandId;var r={p:a.p,uuid:readCookie("uuid")?readCookie("uuid"):"",sku:i||"",pin:decodeURI(readCookie("pin")?readCookie("pin"):""),lid:readCookie("areald")?readCookie("areald"):1,lim:a.lim,sp:"",hi:"",ec:"utf-8",ck:"pin,aview"};jQuery.ajax({url:a.url,data:r,dataType:"jsonp",timeout:a.timeout,success:function(t){e(t),o.find(a.attentNode).length>0&&jshop.module.saleAttent.call(n,{attentType:"brand"}),jshop.module.isScreen.call(n,a,function(){jshop.module.newImage([n.find(a.isScreenNode).attr("data-impr")])}),n.find(a.domNode).click(function(){jshop.module.newImage([jQuery(this).attr("data-clk")])}),jshop.module.autoTag.call(n,{node:a.domNode})},error:function(){/\/\//.test(a.pageUrl)&&(location.href=a.pageUrl),n.find(a.staticHtml).length>0&&(o.html(n.find(a.staticHtml).html()).addClass(a.current),o.find(a.attentNode).length>0&&jshop.module.saleAttent.call(n,{attentType:"brand"}),jshop.module.autoMercury.call(n,a))}})}()},getBrandLogo:function(t){var e=$.extend({node:".goods-logo img",dataBrandId:"data-brandid",attentNode:".e-attention",dataId:"data-id",dataNum:100,url:INTERFACE.actJshop.brandinfo},t),a=$(this),n=a.find(e.node);n.length&&function(){var t=[];n.each(function(a,n){t.push($(n).attr(e.dataBrandId))});for(var a=Math.ceil(t.length/e.dataNum),o=0;o<a;o++){var i=t.slice(o*e.dataNum,Math.min(t.length,(o+1)*e.dataNum));$.ajax({url:e.url,data:{brandIds:i.join(",")},dataType:"jsonp",success:function(t){$.each(t,function(t,a){a.mainBrandId&&a.mainBrandId!=a.brandId&&jQuery(e.node+"["+e.dataBrandId+"="+a.brandId+"]").closest("li").each(function(t,n){var o=jQuery(n).find("a"),i=o.attr("href").replace(/\d+\.html/g,a.mainBrandId+".html");o.attr("href",i),jQuery(n).find(e.attentNode)&&jQuery(n).find(e.attentNode).attr(e.dataId,a.mainBrandId)}),a.logoUrl&&(/\/\//.test(a.logoUrl)||(a.logoUrl="//img30.360buyimg.com/jgsq-productsoa/"+a.logoUrl),jQuery(e.node+"["+e.dataBrandId+"="+a.brandId+"]").attr("src",a.logoUrl).css("display","block"))})}})}}()},showAppPriceCoupon:function(t){function e(e,a){var n=0,e=parseFloat(e),a=parseFloat(a);return 1===t.couponType?n=parseInt(100*e-100*a,10)/100:2===t.couponType&&(n=parseInt(100*a/e,10)/10),n}var a=$(this),n=[],o=[],i=INTERFACE.price.jdMobile;t=$.extend({jdPriceNode:".j-jd-price",appPriceNode:".j-app-price",couponPriceNode:".j-coupon-price",couponType:1,skuAttName:"sku",itemNode:"li",noAppPriceHandle:""},t),$(this).find(t.appPriceNode).each(function(){n.push($(this).attr("sku")),o.push("J_"+$(this).attr("sku"))}),n.length&&function(n){for(var r=0;r<n.length;r+=20)$.ajax({url:i+"?skuids="+n.slice(r,r+20).join(",")+"&origin=2",type:"get",dataType:"jsonp",success:function(n){if(n&&n.constructor===Array)for(var o=0;o<n.length;o++){var i=n[o],r=i.id,s=+i.p<=0?"暂无价格":i.p,d="["+t.skuAttName+"='"+r+"']",u=a.find(t.jdPriceNode+d),c=a.find(t.appPriceNode+d).text(s);if(""!==u.text()){var l=e(u.text(),s),f=c.closest(t.itemNode),p=a.find(t.couponPriceNode+d);isNaN(l)||l<=0||2===t.couponType&&10===l?f.addClass(t.noAppPriceClass):p.text(l)}}}}),$.ajax({url:INTERFACE.price.jd+"?skuids="+o.slice(r,r+20).join(","),type:"get",dataType:"jsonp",success:function(n){if(n&&n.constructor===Array)for(var o=0;o<n.length;o++){var i=n[o],r=i.id.substring(2,i.id.length),s="-1"===i.p?"暂无价格":i.p,d="["+t.skuAttName+"='"+r+"']",u=a.find(t.appPriceNode+d);if(a.find(t.jdPriceNode+d).text(s),""!==u.text()){var c=e(s,u.text()),l=u.closest(t.itemNode),f=a.find(t.couponPriceNode+d);isNaN(c)||c<=0||2===t.couponType&&10===c?l.addClass(t.noAppPriceClass):f.text(c)}}}})}(n)},renderHTML:function(t,e){for(var a,n=t,o=/{([\w-_]+)}/;a=n.match(o);)n=n.replace(o,e[a[1]]);return n},changePageUrl:function(t){var e=jQuery.extend({value:"sale",url:"//www.jd.com"},t||{});-1!=location.href.indexOf(e.value)&&(location.href=e.url)},userGetCoupon:function(t){var e=jQuery.extend({node:"a",dataAttr:"data-href"},t||{}),a=jQuery(this),n=a.find(e.node);if(n.length){var o=function(t){var e=/[?&]roleId=([^?&]*)/i,a=t.match(e)[1]||"",n=/[?&]key=([^?&]*)/i,o=t.match(n)[1]||"",i=/[?&]to=([^?&]*)/i,r=t.match(i)[1]||"";$.jdThickBox({type:"iframe",title:"免费抢券",source:"http://active.coupon.jd.com/ilink/couponActiveFront/ifram_index.action?key="+o+"&roleId="+a+"&to="+r+"&r="+Math.random(),width:800,height:450,_title:"thicktitler",_close:"thickcloser",_con:"thickconr"})},i=function(t){thick_login(function(){o(t)})};n.click(function(){var t=jQuery(this).attr(e.dataAttr);i(t)})}},clickToFly:function(t){var e=jQuery.extend({clickToFlyNode:"a",desNode:".fly-des em",flyNode:".fly-elems img",tipNode:".fly-elems .tip"},t||{}),a=this;jQuery(e.clickToFlyNode).click(function(){var t=jQuery(this),n=jQuery(e.desNode),o=jQuery(a).find(e.flyNode).clone(),i=jQuery(a).find(e.tipNode).clone();0!=n.length&&(o.css({"z-index":9e3,display:"block",position:"absolute",top:t.offset().top+"px",left:t.offset().left+"px",width:"13px",height:"12px"}),jQuery("body").append(o).append(i),o.animate({top:n.offset().top+13,left:n.offset().left+11,opacity:0},1e3),setTimeout(function(){i.html("+1").css({"z-index":2147483647,display:"block",position:"absolute",width:"37px",height:"37px",top:n.offset().top,left:n.offset().left,color:"#FFF116",opacity:1,"text-align":"center","font-size":"18px"}).animate({top:n.offset().top-15,opacity:0},800),setTimeout(function(){i.remove(),o.remove()},800)},1e3))})},attentStoreOrAct:function(t){var e=jQuery.extend({attentNode:"a",shopId:"shop-id",actId:"act-id",typeUrl:"url"},t||{}),a=$(this),n=a.find(e.attentNode),o=0;n.each(function(){var t=$(this),a=t.parent();switch(o=returnUrlType(t.attr(e.typeUrl)),t.attr("data-type",2),a.addClass("attentScope"),o){case 0:case 1:a.saleAttent({attentType:"activity",node:e.attentNode,dataId:"act-id",current:"favor-handle",activityType:o});break;case 2:a.saleAttent({attentType:"vender",node:e.attentNode,dataId:"shop-id",current:"favor-handle"})}})},getGoodsAttentCount:function(t){var e=$,a=e.extend({skuNode:"li",countNode:".JAttentCount",skuName:"skuid"},t),n=e(this),o=n.find(a.skuNode),i=[];if(0!==o.length){o.each(function(t,e){i.push(e.getAttribute(a.skuName))});for(var r=0;r<i.length;r+=10)e.ajax({url:INTERFACE.actJshop.attentionCount,type:"GET",dataType:"jsonp",data:{type:0,attentionIds:i.slice(r,r+10).join(",")},success:function(t){if(t&&t.length>0)for(var e=0;e<t.length;e++){var o=n.find(a.skuNode+"["+a.skuName+"='"+t[e].productId+"']");o.find(a.countNode).text(t[e].count)}}})}},getWechatPrice:function(t){var e=$,a=e.extend({skuNode:"li",wechatPriceNode:".jQrCode .wechatNum",skuName:"skuid"},t),n=e(this),o=n.find(a.skuNode),i=[];if(0!==o.length){o.each(function(t,e){i.push(e.getAttribute(a.skuName))});for(var r=0;r<i.length;r+=10)e.ajax({url:"//pe.3.cn/prices/pcpmgets",type:"GET",dataType:"jsonp",data:{skuids:i.slice(r,r+10).join(","),origin:5,source:"jshop"},success:function(t){if(t&&t.length>0)for(var e=0;e<t.length;e++){var o=n.find(a.wechatPriceNode+"["+a.skuName+"='"+t[e].id+"']");t[e].p&&t[e].p>0?o.text(t[e].p):o.text("暂无价格")}}})}},autoMercury:function(t){function e(){var t=r.map(function(){return jQuery(this).attr(n.dataSkuId)}).toArray().join(","),e=i.find(n.domBrand).map(function(){return $(this).attr(n.dataBrandId)}).toArray().join(","),a=new Array(r.length+1).join("0,"),o=n.urlMercury+"?t=rec."+n.t+"&v="+n.v+"$action=0$reqsig="+n.reqsig+"$enb="+n.enb+"$csku="+t+"$index="+n.index+"$st="+a.substring(0,a.length-1)+"$p="+n.t+"$pin="+n.pin+"$uuid="+n.uuid+"$expid="+n.expid+"$gm=brandid^"+e+"&rid="+n.rid+"&ver="+n.ver+"&sig="+n.sig;i.attr("data-impr",o)}function a(){r.each(function(t,e){var a=n.urlMercury+"?t=rec."+n.t+"&v="+n.v+"$action=1$reqsig="+n.reqsig+"$enb="+n.enb+"$csku="+jQuery(e).attr(n.dataSkuId)+"$index="+t+"$st=0$p="+n.t+"$pin="+n.pin+"$uuid="+n.uuid+"$expid="+n.expid+"$im=brandid^"+jQuery(e).find(n.domBrand).attr(n.dataBrandId)+"&rid="+n.rid+"&ver="+n.ver+"&sig="+n.sig;jQuery(e).attr("data-clk",a)})}var n=jQuery.extend({isScreenNode:"ul",urlMercury:INTERFACE.mercury.log,domShow:"ul",domClick:"li",domBrand:".brand-logo img",dataSkuId:"data-skuId",dataBrandId:"data-brandid",t:"",v:"src=rec",action:0,reqsig:"human",enb:1,csku:"",index:"",st:"",p:"",pin:decodeURI(readCookie("pin")?readCookie("pin"):""),uuid:readCookie("uuid")?readCookie("uuid"):-1,expid:"",gm:"",im:"",rid:"",ver:"",sig:""},t||{}),o=jQuery(this),i=o.find(n.domShow),r=i.find(n.domClick);!function(){e(),a(),jshop.module.isScreen.call(o,n,function(){jshop.module.newImage([o.find(n.isScreenNode).attr("data-impr")])}),r.click(function(){jshop.module.newImage([jQuery(this).attr("data-clk")])})}()},autoTag:function(t){var e=jQuery.extend({node:"a"},t||{}),a=jQuery(this),n=a.find(e.node),o=a.closest("div[instanceid]").attr("instanceid");n.each(function(t,e){jQuery(e).attr("clstag","sale|keycount|"+o+"|"+t)})},isScreen:function(t,e){var a=jQuery.extend({isScrrenNode:"a",isScroll:!0},t||{}),n=jQuery(this),o=n.find(a.isScrrenNode);a.isScroll?jQuery(window).scroll(function(){o.offset().top<=$(window).scrollTop()+(document.documentElement.clientHeight||document.body.clientHeight)&&!o.hasClass("currentScreen")&&(e.call(),o.addClass("currentScreen"))}):e.call()},newImage:function(t){for(var e=0;t[e];e+=1){var a=t[e],n=new Image;"data-clk"!=a&&(a=a+"&m=UA-J2011-1&ref="+encodeURIComponent(document.referrer)+"&random="+Math.random(),n.setAttribute("src",a.replace(/https?:/,"")))}},waresShare:function(t){var e={shareType:"1",shareClass:".shareType"},a={facebook:"http://en.jd.com/",vk:"http://en.jd.com/",ok:"http://en.jd.com/"},n=$.extend(e,t),o=$(this),i="0"==n.shareType?"_self":"_blank";o.find(n.shareClass).unbind("click").bind("click",function(){var t,e,n=$(this).attr("skuId")?$(this).attr("skuId"):null,o=$(this).attr("shareType");switch(o){case"facebook":t=null!=n?a.facebook+n+".html":window.location.href,window.open("http://www.facebook.com/sharer.php?u="+t+"&t="+encodeURIComponent(document.title),i);break;case"vk":null!=n?(t=a.vk+n+".html",e=$(this).attr("imgUrl"),window.open("http://vk.com/share.php?url="+encodeURIComponent(t)+"&title="+encodeURIComponent(document.title)+"&image="+encodeURIComponent(e),i)):(t=window.location.href,window.open("http://vk.com/share.php?url="+encodeURIComponent(t)+"&title="+encodeURIComponent(document.title),i));break;case"ok":t=null!=n?a.ok+n+".html":window.location.href,window.open("http://connect.ok.ru/dk?cmd=WidgetSharePreview&st.cmd=WidgetSharePreview&st.shareUrl="+encodeURIComponent(t),i)}})},realSkuInfo:function(t){for(var e=[],a=jQuery(this),n=a.find("input.skuid-list"),o=a.find(".js-realsku-tpl").html(),i=0;i<n.length;i++)e.push(jQuery(n[i]).val());jQuery.when(getRealGoods(e.join(","),"recomCallback")).done(function(t,e){if($.when(makeTpltoHtml(t,o)).done(function(t){a.find(".js-realsku-tpl").replaceWith("<ul>"+t+"</ul>")}),jQuery("#pageType")&&"view"==jQuery("#pageType").val())$(document).trigger("newDomLoad",a);else{var n=a.find("a"),i=a.closest("div[instanceid]").attr("instanceid");n.each(function(t,e){jQuery(e).attr("clstag","sale|keycount|"+i+"|"+t)})}})},realCombInfo:function(){var t=[],e=jQuery(this),a=e.find("script[mainsku]").attr("mainsku"),n=e.find("input.skuid-list"),o=e.find("script[mainsku]").html(),i=e.find(".js-comb-tpl").html(),r=e.find(".js-total-tpl").html();jQuery.when(getRealGoods(a,"combMainCallback")).done(function(t,a){$.when(makeTpltoHtml(t,o)).done(function(t){e.find("script[mainsku]").replaceWith(t)}),$.when(makeTpltoHtml(t,r)).done(function(t){e.find(".js-total-tpl").replaceWith(t)})});for(var s=0;s<n.length;s++)t.push(jQuery(n[s]).val());jQuery.when(getRealGoods(t.join(","),"combSubCallback")).done(function(t,a){$.when(makeTpltoHtml(t,i)).done(function(t){e.find(".js-comb-tpl").replaceWith("<ul>"+t+"</ul>")})})},realClassRecom:function(){for(var t=[],e=jQuery(this),a=e.find("script[data-skuid]"),n=0;n<a.length;n++)t.push(jQuery(a[n]).data("skuid"));jQuery.when(getRealGoods(t.join(","),"classRecomCallback")).done(function(t,e){for(var n=0;n<a.length;n++){var o;!function(n){o=jQuery(a[n]).html();for(var i=0;i<t.length;i++)!function(i){t[i].goodsId==e[jQuery(a[n]).data("skuid")].realSkuId&&seajs.use("public/utils/JsonUtils",function(e){jQuery(a[n]).replaceWith(e.render(t[i],o))})}(i)}(n)}})},showEnterMemberPrice:function(t){function e(){o.find(n.triggerLoginNode).bind("click",function(){thick_login(function(){a()})})}function a(){var t=[],e=[];i.each(function(){var a=$(this);t.push(a.attr(n.skuName)),e.push(a.attr(n.widName))}),r.getData(t.join(","),e.join(","),function(t){for(var e=0;e<t.length;e++){var a=t[e].id,i=o.find(n.itemNode+"["+n.skuName+'="'+a+'"]');i.addClass(n.loginClass),r.showItemMemberPrice(t[e])&&i.addClass(n.memberClass)}})}var n=jQuery.extend({itemNode:"li",skuName:"skuid",widName:"wid",loginClass:"g-login",memberClass:"g-has",memberPriceNode:".j-member-price",triggerLoginNode:".j-trigger-login"},t||{}),o=$(this),i=o.find(n.itemNode),r={getData:function(t,e,a){$.ajax({url:INTERFACE.actJshop.promoInfo,dataType:"jsonp",data:{skuids:t,origin:1,pin:readCookie("pin"),wid:e,area:readCookie("ipLoc-djd")||"0-0-0"},success:function(t){a(t)}})},showItemMemberPrice:function(t){if(t&&"90"===t.jl&&t.pis)for(var e=t.pis,a=t.id,i=0;i<e.length;i++){var r=e[i][1];if(r){var s=r.split("!");if(3===s.length&&"90.00"===s[0])return o.find(n.memberPriceNode+"["+n.skuName+'="'+a+'"]').text(s[2]),!0}}}};i.length&&checkLogin(a,function(){e()})},showSchedule:function(t){jQuery.extend({urlNode:".buy-now a",scheduleNumNode:".yd-num em",priceNode:".jd-price em",prepaidNode:".depositWorth",worthNode:".expAmount"},t||{});$(this).find("li").each(function(t){var e=$(this),a=e.attr("skuid"),n=null,o=null;!function(t){jQuery.ajax({type:"post",dataType:"jsonp",url:INTERFACE.yuding.getPresaleInfo,data:{sku:a},success:function(e){e.ret?(n=(e.ret.earnest+"").replace(/(\.00)/g,""),o=(e.ret.depositWorth+"").replace(/(\.00)/g,""),t.find(".buy-now a").attr("href",e.ret.url),t.find(".yd-num em").html(e.ret.count),t.find(".jd-price em").html(e.ret.oriPrice),t.find(".depositWorth").html(o),t.find(".expAmount").html(n)):(t.find(".jd-price").html("暂无信息"),t.find(".dingjin").html("暂无信息"))}})}(e)})},log618Sku:function(t){var e=jQuery.extend({skuNode:"li",clickNode:"a"},t||{}),a=$(this),n=readCookie("pin"),o={sendLog:function(t,a){if("click"===t){var o=new Image;url="//mercury.jd.com/log.gif?t=rec.619040&v=src=rec$action=1$reqsig=human$enb=1$sku=$p=610009$pin={{pin}}$uuid=$csku={{skuid}}$index={{index}}$st=0$adcli=$expid=&rid=&ver=&sig=".replace("{{pin}}",n).replace("{{skuid}}",a.closest(e.skuNode).attr("skuid")).replace("{{index}}",a.closest("li").index()),url&&(o.src=url+"&randomT="+(new Date).getTime())}else{var o=new Image;url="//mercury.jd.com/log.gif?t=rec.619040&v=src=rec$action=0$reqsig=human$enb=1$sku=0$p=610009$pin={{pin}}$uuid=$csku={{skuid}}$index=$st=0$adcli=$expid=&rid=&ver=&sig=".replace("{{pin}}",n).replace("{{skuid}}",a.find(e.skuNode).map(function(){return $(this).attr("skuid")}).toArray().join(",")),url&&(o.src=url+"&randomT="+(new Date).getTime())}}};a.delegate(e.clickNode,"click",function(){o.sendLog("click",$(this))}),$(window).data("scrollLog618Sku")?jshop.module.log618Sku.arrTarget.push(a):(jshop.module.log618Sku.arrTarget=[a],$(window).data("scrollLog618Sku",!0),$(window).scroll(function(){for(var t=jshop.module.log618Sku.arrTarget,e=0;e<t.length;e++){var a=t[e];if(!a.hasClass("logCpt")){a.offset().top<=$(window).scrollTop()+(document.documentElement.clientHeight||document.body.clientHeight)&&(o.sendLog("show",a),a.addClass("logCpt"))}}}))},log618Act:function(t){var e=jQuery.extend({clickNode:"a"},t||{}),a=$(this),n=readCookie("pin"),o={getActId:function(t){if(t.length>7){var e=t.indexOf("sale.jd.com/act/"),a=t.indexOf("mall.jd.com/"),n=t.indexOf(".jd.com");return e>-1?"s_"+t.substring(e+16,t.indexOf(".html")):a>-1?"m_"+t.substring(a+12,t.indexOf(".html")):n>-1?"d_"+t.substring(t.indexOf("//")+2,n):""}return""},sendLog:function(t,a){if("click"===t){var i=o.getActId(a.attr("href"));if(i){var r=new Image;url="//mercury.jd.com/log.gif?t=rec.619038&v=src=rec$action=1$reqsig=human$enb=1$sku=$p=610009$pin={{pin}}$uuid=$csku={{actid}}$index={{index}}$st=0$adcli=$expid=&rid=&ver=&sig=".replace("{{pin}}",n).replace("{{actid}}",i).replace("{{index}}",a.closest("li").index()),url&&(r.src=url+"&randomT="+(new Date).getTime())}}else{var s=[];a.find("li").each(function(){var t=o.getActId($(this).find(e.clickNode).eq(0).attr("href"));t&&s.push(t)});var r=new Image;url="//mercury.jd.com/log.gif?t=rec.619038&v=src=rec$action=0$reqsig=human$enb=1$sku=0$p=619038$pin={{pin}}$uuid=$csku={{actid}}$index=$st=0$adcli=$expid=&rid=&ver=&sig=".replace("{{pin}}",n).replace("{{actid}}",s.join(",")),url&&(r.src=url+"&randomT="+(new Date).getTime())}}};a.delegate(e.clickNode,"click",function(){o.sendLog("click",$(this))}),$(window).data("scrollLog618Act")?jshop.module.log618Act.arrTarget.push(a):(jshop.module.log618Act.arrTarget=[a],$(window).data("scrollLog618Act",!0),$(window).scroll(function(){for(var t=jshop.module.log618Act.arrTarget,e=0;e<t.length;e++){var a=t[e];if(!a.hasClass("logCpt")){a.offset().top<=$(window).scrollTop()+(document.documentElement.clientHeight||document.body.clientHeight)&&(o.sendLog("show",a),a.addClass("logCpt"))}}}))},getAareaStockState:function(t){function e(t,e){for(var n='<div class="p-stock">state</div>',o=0;t[o];o++)if("33"!=e[t[o]].a){0==jQuery("#styleStock").length&&jQuery("body").append('<style id="styleStock">.p-stock{position:absolute;bottom:0;left:0;right:0;z-index:30;line-height:25px;height:25px; font-size:12px; color:#fff;filter:progid:DXImageTransform.Microsoft.gradient(enabled="true", startColorstr="#66000000", endColorstr="#66000000");background:rgba(0,0,0,.4);text-align:left; text-indent:10px;}</style>');var i=jQuery(a.domStockState+"["+a.attrSkuName+"="+t[o]+"]").find(a.domImg);"static"==i.css("position")&&i.css("position","relative"),i.append(n.replace(/state/,a.state[e[t[o]].a]))}}var a=jQuery.extend({domStockState:"li",domImg:".jPic",attrSkuName:"data-sku",num:100,app:"jshop_web",ch:1,area:CookieUtil.getCookie("ipLoc-djd")?CookieUtil.getCookie("ipLoc-djd").replace(/-/g,","):0,coord:"",site:"",t:(new Date).getTime(),state:{33:"现货",34:"无货",39:"在途",36:"预订",40:"可配货"}},t||{}),n=jQuery(this),o=n.find(a.domStockState);o.length&&0!=a.area&&function(){var t=[];o.each(function(e,n){t.push($(n).attr(a.attrSkuName))});for(var n=Math.ceil(t.length/a.num),i=0;i<n;i++){var r=t.slice(i*a.num,Math.min(t.length,(i+1)*a.num));$.ajax({url:INTERFACE.ss.areaStockState,data:{app:a.app,skuNum:r.join(";"),ch:a.ch,area:a.area,coord:a.coord,site:a.site,t:a.t},dataType:"jsonp",success:function(t){e(r,t)}})}}()},getGoodsInfo:function(t){var e=jQuery.extend({domCon:"ul",domTemplateHtml:"#J_TemplateHtml",current:"current",num:100,skuInfo:[],isJx:1},t||{}),a=jQuery(this),n=a.find(e.domTemplateHtml).html(),o=e.skuInfo;e.num;o&&0==o.length||function(t,o){if(1===e.isJx)var i={skuIds:t.join(","),isJx:1};else var i={skuIds:t.join(",")};jQuery.ajax({url:INTERFACE.actJshop.goodsInfo,data:i,dataType:"jsonp",success:function(t){for(var i=0;t[i];i++){var r=t[i].categoryIds.replace(/;/g,","),s=t[i].fqsp?t[i].fqsp:0,d=t[i].venderId?t[i].venderId:0;str=' data-cat="'+r+'" data-fqsp="'+s+'" data-venderId="'+d+'"',t[i].imageUrl="//img14.360buyimg.com/n7/"+t[i].imageurl,t[i].jsprice='<span jshop="price" class="jdNum" jsprice="'+t[i].goodsId+'"'+str+">&nbsp;</span>",t[i].jdPrice='<span jshop="price" class="jdNum" jdprice="'+t[i].goodsId+'"'+str+">&nbsp;</span>",t[i].jspprice='<span jshop="price" class="jdNum" jspprice="'+t[i].goodsId+'"'+str+">&nbsp;</span>",t[i].jppprice='<span jshop="price" class="jdNum" jppprice="'+t[i].goodsId+'"'+str+">&nbsp;</span>",t[i].jtppprice='<span jshop="price" class="jdNum" jtppprice="'+t[i].goodsId+'"'+str+">&nbsp;</span>",t[i].jtkpprice='<span jshop="price" class="jdNum" jtkpprice="'+t[i].goodsId+'"'+str+">&nbsp;</span>",t[i].jprice='<span jshop="price" class="jdNum" jprice="'+t[i].goodsId+'"'+str+">&nbsp;</span>","yhd"===$("#JSHOP_CHANNEL_FLAG").val()?(t[i].cartUrl="//cart.yhd.com/cart/opt/add.do?pid="+t[i].goodsId+"&pcount=1&ptype=1",t[i].itemUrl="//item.yhd.com/"+t[i].goodsId+".html"):(t[i].cartUrl="//gate.jd.com/InitCart.aspx?pid="+t[i].goodsId+"&pcount=1&ptype=1",t[i].itemUrl="//item.jd.com/"+t[i].goodsId+".html"),o[i].promTag&&(t[i].promTag=o[i].promTag),o[i].promTag2&&(t[i].promTag2=o[i].promTag2),o[i].forwardType&&(t[i].forwardType=o[i].forwardType)}seajs.use("public/utils/JsonUtils",function(o){var i=o.render(t,n);a.find(e.domCon).append(i).addClass(e.current),a.find(e.domTemplateHtml).remove(),jshop.module.autoQuene.call(a,e)})}})}(function(t){for(var e=[],a=0;t[a];a++)e.push(t[a].goodsId);return e}(o),o)},getTokenPriceInfo:function(t){var e=Object.assign({skuInfo:[],tokenId:290688,skuAttName:"jtokenprice"},t||{}),a=(jQuery(void 0),e.skuInfo);!function(t){for(var a=0;a<t.length;a+=20){var n={sku:t.slice(a,a+20).join(","),tokenId:e.tokenId};$.ajax({url:INTERFACE.actJshop.tokenPrice,data:n,dataType:"jsonp",success:function(t){if(t&&t.constructor===Array)for(var a=0;a<t.length;a++){var n=jQuery("["+e.skuAttName+"='"+t[a].sku+"']"),o="";-1==t[a].price?o="暂无定价":t[a].flag?o=t[a].price.toFixed(2):n.attr("jdprice",t[a].sku).attr("jshop","price"),n.text(o)}}})}}(function(t){for(var e=[],a=0;t[a];a++)e.push(t[a].goodsId);return e}(a))},getYaoGoodsInfo:function(t){var e=jQuery.extend({node:"li",attrName:"data-sku",dataNum:50,url:INTERFACE.moduleJshop.getYaoGoodsInfo,producer:".J-Producer",seller:".J-Seller"},t),a=jQuery(this),n=a.find(e.node);if(n.length){var o=[];!function(){n.each(function(t,e){
o.push(jQuery(e).attr("data-sku"))})}(),function(){for(var t=Math.ceil(o.length/e.dataNum),n=0;n<t;n++){var i=o.slice(n*e.dataNum,Math.min(o.length,(n+1)*e.dataNum));jQuery.ajax({url:e.url,data:{skuStr:i.join(",")},dataType:"jsonp",success:function(t){jQuery.each(t,function(t,n){a.find(e.node+"[data-sku="+n.sku+"]").find(e.producer).html(n.manu),a.find(e.node+"[data-sku="+n.sku+"]").find(e.seller).html(n.shopName)})}})}}()}},getAreaGoods:function(t){var e=$.extend({tolNode:".js-goods-tpl",goodsNode:".js-original-goods",modeName:$(this).closest("[module-name]").attr("module-name")},t),a=getArea(),n="",o=$(this),i=$(this).find(e.tolNode).html(),r=$(this).find(e.goodsNode).html(),s=$.parseJSON($.trim(r));if("true"==o.attr("refreshed"))return!1;if(!s||s.length<1)return!1;switch(e.modeName){case"sortRec":$.each(s,function(t,e){$.each(e.goodsList,function(t,e){n+=e.goodsId+","})});break;default:$.each(s,function(t,e){n+=e.goodsId+","})}$.ajax({url:INTERFACE.realSku.partition,data:{skuIds:n,area:a,bizType:1,cat:"0,0,0",app:"test"},dataType:"jsonp",success:function(t){var a=[];for(var n in t){a.push(t[n].realSkuId);for(var r=0,d=s.length;r<d;r++)if("sortRec"==e.modeName){if(!s[r].goodsList)continue;for(var u=s[r].goodsList,c=0,l=u.length;c<l;c++)n==u[c].goodsId&&(u[c].goodsId=t[n].realSkuId)}else n==s[r].goodsId&&(s[r].goodsId=t[n].realSkuId)}$.ajax({url:INTERFACE.actJshop.goodsInfo,data:{skuIds:a.join(",")},dataType:"jsonp",success:function(t){if(t&&t.length>0)for(var a=0,n=t.length;a<n;a++)for(var r=0,d=s.length;r<d;r++)if("sortRec"==e.modeName){if(!s[r].goodsList)continue;for(var u=s[r].goodsList,c=0,l=u.length;c<l;c++)t[a].goodsId==u[c].goodsId&&(u[c].wname=t[a].wname,u[c].imageurl=t[a].imageurl,u[c].categoryIds=t[a].categoryIds)}else t[a].goodsId==s[r].goodsId&&(s[r].wname=t[a].wname,s[r].imageurl=t[a].imageurl,s[r].categoryIds=t[a].categoryIds);seajs.use("public/utils/JsonUtils",function(t){var a=t.render(s,i),n="";n="sortRec"==e.modeName?a:'<ul class="clearfix">'+a+"</ul>",o.find(e.tolNode).replaceWith(n),o.attr("refreshed")||(o.attr("refreshed","true"),o.closest("[instanceid]").attr("module-refresh",!0),window.moduleRefresh.call(o)),$(document).trigger("newDomLoad",o.closest("[instanceid]"))})}})}})},getAreaSku:function(t){function e(t,e){for(var a=t,n=0;n<e.tplData.length;n++){var o=e.tplData[n];a=a.replace(new RegExp(o.str,"g"),o.data)}return a}var a=jQuery.extend({itemNode:".item",liNode:"li"},t||{}),n=jQuery(this),o=getArea(),i="";n.find("[skuid]").each(function(){i+=$(this).attr("skuid")+","});var r=[];$.ajax({url:INTERFACE.realSku.partition,data:{skuIds:i,area:o,bizType:1,cat:"0,0,0",app:"test"},dataType:"jsonp",success:function(t){var i=function(t){var e=[];for(var a in t)e.push(t[a].realSkuId);return e.join(",")}(t),s=function(t){var e=[];for(var a in t)e.push("J_"+t[a].realSkuId);return e.join(",")}(t);for(var d in t){var u={};u.oldSku=d,u.newSku=t[d].realSkuId,u.tplData=[];var c={data:t[d].realSkuId,str:"{{newSku}}"};u.tplData.push(c),r.push(u)}var l=$.ajax({url:INTERFACE.actJshop.goodsInfo,data:{skuIds:i},dataType:"jsonp",success:function(t){for(var e=0;e<t.length;e++)for(var a=0;a<r.length;a++)if(r[a].newSku==t[e].goodsId){var n=r[a].tplData,o={data:"//img14.360buyimg.com/n1/"+t[e].imageurl,str:"{{imageurl}}"},i={data:t[e].wname,str:"{{wname}}"},s={data:"//item.jd.com/"+r[a].newSku+".html",str:"{{href}}"},d={data:"//cart.jd.com/cart/dynamic/gate.action?pid="+r[a].newSku+"&pcount=1&ptype=1",str:"{{cartHref}}"},u={data:r[a].newSku,str:"{{goodsId}}"};n.push(o),n.push(i),n.push(s),n.push(d),n.push(u)}}}),f=$.ajax({url:INTERFACE.price.jd,data:{skuids:s,area:o,source:"jshop"},dataType:"jsonp",success:function(t){for(var e=0;e<t.length;e++)t[e].id=t[e].id.substring(2,t[e].id.length);for(var e=0;e<t.length;e++)for(var a=0;a<r.length;a++)if(r[a].newSku==t[e].id){var n=r[a].tplData,o={data:t[e].p,str:"{{jdprice}}"};n.push(o)}}});$.when(l,f).done(function(){n.find(a.itemNode).each(function(){var t=$(this),a=t.html(),n=t.attr("skuid");for(var o in r)if(r[o].oldSku==n){var i=e(a,r[o]);t.html(i)}});for(var t=0;t<r.length;t++)r[t].newSku!=r[t].oldSku&&n.find("[skuid="+r[t].oldSku+"]").each(function(){$(this).attr("skuid",r[t].newSku)})})}})},getAreaSkuNoTpl:function(t){function e(t,e){for(var a=t,n=0;n<e.tplData.length;n++){var o=e.tplData[n];a=a.replace(new RegExp(o.str,"g"),o.data)}return a}var a=jQuery.extend({itemNode:".item",liNode:"li"},t||{}),n=jQuery(this),o=getArea(),i="";n.find("[skuid]").each(function(){i+=$(this).attr("skuid")+","});var r=[];$.ajax({url:INTERFACE.realSku.partition,data:{skuIds:i,area:o,bizType:1,cat:"0,0,0",app:"test"},dataType:"jsonp",success:function(t){var i=function(t){var e=[];for(var a in t)e.push(t[a].realSkuId);return e.join(",")}(t),s=function(t){var e=[];for(var a in t)e.push("J_"+t[a].realSkuId);return e.join(",")}(t);for(var d in t){var u={};u.oldSku=d,u.newSku=t[d].realSkuId,u.tplData=[];var c={data:t[d].realSkuId,str:"{{newSku}}"};u.tplData.push(c),r.push(u)}var l=$.ajax({url:INTERFACE.actJshop.goodsInfo,data:{skuIds:i},dataType:"jsonp",success:function(t){for(var e=0;e<t.length;e++)for(var a=0;a<r.length;a++)if(r[a].newSku==t[e].goodsId){var n=r[a].tplData,o={data:"//img14.360buyimg.com/n1/"+t[e].imageurl,str:"{{imageurl}}"},i={data:t[e].wname,str:"{{wname}}"},s={data:"//item.jd.com/"+r[a].newSku+".html",str:"{{href}}"},d={data:"//cart.jd.com/cart/dynamic/gate.action?pid="+r[a].newSku+"&pcount=1&ptype=1",str:"{{cartHref}}"},u={data:r[a].newSku,str:"{{goodsId}}"};n.push(o),n.push(i),n.push(s),n.push(d),n.push(u)}}}),f=$.ajax({url:INTERFACE.price.jd,data:{skuids:s,area:o,source:"jshop"},dataType:"jsonp",success:function(t){for(var e=0;e<t.length;e++)t[e].id=t[e].id.substring(2,t[e].id.length);for(var e=0;e<t.length;e++)for(var a=0;a<r.length;a++)if(r[a].newSku==t[e].id){var n=r[a].tplData,o={data:t[e].p,str:"{{jdprice}}"};n.push(o)}}});$.when(l,f).done(function(){n.find(a.itemNode).each(function(){var t=$(this),a=t.html(),n=t.attr("skuid");for(var o in r)if(r[o].oldSku==n){var i=e(a,r[o]);t.html(i)}}),n.show();for(var t=0;t<r.length;t++)r[t].newSku!=r[t].oldSku&&n.find("[skuid="+r[t].oldSku+"]").each(function(){$(this).attr("skuid",r[t].newSku)})})}})},companyPromotion:function(t){var e=$.extend({itemNode:"li",jdpriceNode:".jdNum",companyPriceNode:".company-price",companyPriceAttr:"data-companyprice",endTimeAttr:"data-endtime",endWarpNode:".d-end"},t||{}),a={},n=$(this),o=n.find(e.itemNode);!function(){for(var t=0;t<o.length;t++){var n=$(o[t]),i=n.attr("skuid"),r=n.attr(e.companyPriceAttr);_endTime=n.attr(e.endTimeAttr),a[i]={},a[i].companyPrice=r,a[i].endTime=_endTime}}();var i=function(t){var e=[];for(var a in t)e.push("J_"+a);return e.join(",")}(a),r=$.ajax({url:INTERFACE.price.jd,data:{skuids:i,area:CookieUtil.getCookie("ipLoc-djd")?CookieUtil.getCookie("ipLoc-djd").replace(/-/g,"_"):"",source:"jshop"},dataType:"jsonp",success:function(t){for(var e=0;e<t.length;e++)a[t[e].id.substring(2)].jdPrice=t[e].p}});$.when(r).done(function(){for(var t=0;t<o.length;t++){var n=$(o[t]),i=n.attr("skuid");new Number(a[i].companyPrice)>=new Number(a[i].jdPrice)&&n.find(e.endWarpNode).show();new Date(a[i].endTime)<new Date&&n.find(e.endWarpNode).show()}})},getAttentCount:function(t){var e,a=jQuery.extend({attentCountNode:".attent-count",idName:"data-id",attentCountType:1},t),n=jQuery(this),o=n.find(a.attentCountNode),i=[];switch(a.attentCountType){case 0:e="productId";break;case 2:e="venderId";break;case 3:e="brandId";break;default:e="activityId"}if(0!==o.length){o.each(function(t,e){i.push(e.getAttribute(a.idName))});for(var r=0;r<i.length;r+=10){if("activityId"==e)var s={type:a.attentCountType,attentionIds:i.slice(r,r+10).join(","),activitySrcType:1};else var s={type:a.attentCountType,attentionIds:i.slice(r,r+10).join(",")};jQuery.ajax({url:INTERFACE.actJshop.attentionCount,type:"GET",dataType:"jsonp",data:s,success:function(t){if(t&&t.length>0)for(var o=0;o<t.length;o++){var i=n.find(a.attentCountNode+"["+a.idName+"='"+t[o][e]+"']");i.attr("data-init")?i.text(Number(i.attr("data-init"))+Number(t[o].count)).removeAttr("data-init"):i.text(t[o].count)}}})}}},getYoupinInfo:function(t){var e=jQuery.extend({tagId:"533",page:"1",uuid:CookieUtil.getCookie("__jda")?CookieUtil.getCookie("__jda").split(".")[1]:"",clientVersion:"1.0.0",build:"23145",client:"wh5",d_brand:"Meizu",d_model:"MX4Pro",osVersion:"4.4.4",screen:"1920*108",partner:"dle006",area:CookieUtil.getCookie("ipLoc-djd")?CookieUtil.getCookie("ipLoc-djd").replace(/-/g,"_"):0,networkType:"wifi",st:"1449775050365",sign:"11d_-dLV9gX4eM9gALFKlw",sv:"1",pin:decodeURI(CookieUtil.getCookie("pin")?CookieUtil.getCookie("pin"):""),current:"current",templateHtml:"#J_templateHtml"},t||{}),a=jQuery(this),n=a.find(e.templateHtml).html(),o={tagId:e.tagId,page:e.page},i={uuid:e.uuid,clientVersion:e.clientVersion,build:e.build,client:e.client,d_brand:e.d_brand,d_model:e.d_model,osVersion:e.osVersion,screen:e.screen,partner:e.partner,area:e.area,networkType:e.networkType,st:e.st,sign:e.sign,sv:e.sv,pin:e.pin,id:e.id};jQuery.ajax({url:INTERFACE.apim.discZdmTagAggList+"&body="+JSON.stringify(o),type:"GET",dataType:"jsonp",data:i,success:function(t){seajs.use("public/utils/JsonUtils",function(o){var i=o.render(t,n);a.html(i).addClass(e.current)})}})},getFavor:function(t){function e(){$.ajax({url:INTERFACE.jshopscene.countUser,dataType:"jsonp",data:{uuid:u,pin:CookieUtil.getCookie("pin")},success:function(t){d=t,r()}})}function a(t,e,a,n){$.ajax({url:INTERFACE.jshopscene.addFavor,dataType:"jsonp",data:{uuid:t,cuuid:e,skuid:a},success:function(t){t.result?n():"0001"==t.resultCode?thick_login(function(){n()}):alert(t.message)}})}function n(){return"//img"+(10+Math.round(4*Math.random()))+".360buyimg.com/n11/"}function o(t,e){return t/e<1?t/e*100:100}function i(t){return"//item.jd.com/"+t+".html"}function r(){d.result&&(s.find(".list").empty(),d.saleCount.saleCountConfigList&&0!==d.saleCount.saleCountConfigList.length&&(d.skuids&&d.skuids.length>0&&"string"==typeof d.skuids&&(d.skuids=d.skuids.split(",")),$.each(d.saleCount.saleCountConfigList,function(t,r){var c=r.saleCountReward.saleCountLadders[r.saleCountReward.saleCountLadders.length-1].num,l=s.find(".item.template").clone().removeClass("template");l.find(".title").text(r.skuName),l.find(".current-person-count").text(r.saleCountReward.sumNum),l.find(".current").css("width",o(r.saleCountReward.sumNum,c)+"%"),l.find(".jizan-tips").css("right",.52*o(r.saleCountReward.sumNum,c)-72+"px"),r.saleCountReward&&0!==r.saleCountReward.saleCountLadders.length&&($.each(r.saleCountReward.saleCountLadders,function(t,e){var a=s.find(".index.template").clone().removeClass("template");a.find(".person-num").text(e.num),t==r.saleCountReward.saleCountLadders.length-1?(r.promotionHidePrice?""===r.promotionShowPriceTime?r.saleCountReward.sumNum>=num?endPrice="限量<br>¥"+r.promotionPrice:endPrice="限量<br>¥"+r.promotionHidePrice:(new Date).getTime()>=new Date(r.promotionShowPriceTime.replace(/-/g,"/")).getTime()?endPrice="限量<br>¥"+r.promotionPrice:endPrice="限量<br>¥"+r.promotionHidePrice:endPrice="限量<br>¥"+r.promotionPrice,a.find(".price").css({left:"initial","min-width":"60px",right:"-10px"}),a.find(".price-num").html(endPrice)):a.find(".price-num").text("¥"+e.price),a.css("left",o(e.num,c)+"%"),e.num<r.saleCountReward.sumNum&&a.find(".jizan-circle").addClass("active"),a.find(".person-count").css("left",-1-.11*o(e.num,c)+"px"),l.find(".progress").append(a)}),l.find(".goods-count").text(d.saleCount.userSkuNum),l.find(".buy").attr("href","//cart.jd.com/gate.action?pid="+r.skuId+"&pcount=1&ptype=1"),l.attr("skuid",r.skuId),l.find(".image-box img").attr("src",n()+r.skuImageurl),l.find(".title,.image-box").attr("href",i(r.skuId)),l.find(".favor").bind("click",function(){$(this).parent();if(d.skuids&&d.skuids.length>=d.saleCount.userSkuNum)return l.find(".pop").removeClass("hide"),void setTimeout(function(){l.find(".pop").addClass("hide")},2e3);a(u,r.countConfigUUID,r.skuId,function(){e()})}),d.skuids&&d.skuids.indexOf(r.skuId)>-1&&(l.find(".button").addClass("active"),l.find(".favor").hide()),2==d.saleCount.status?l.find(".button").addClass("online"):3==d.saleCount.status?l.find(".button").addClass("jizan-end"):4==d.saleCount.status?l.find(".button").addClass("jizan-stop"):l.find(".button").html(""),s.find(".list").append(l))})))}var s=$(this),d={},u=t.uuid;e()},showHtmlVideo:function(t){var e=jQuery.extend({videoNodePar:"#jd-live-video",videoNode:"video_demo",videoButton:".d-btn-play",type:"video/mp4",src:"//https-play-g3proxy.lecloud.com/vod/v2/MjMwLzM5LzE2L2JjbG91ZC8xMDAwMDEvdmVyXzAwXzIyLTEwODIzMjg2NTUtYXZjLTQxOTk4My1hYWMtNDgwMDAtODg5MDE2MC01MzM0MjczNTItNDYyY2JhYmFlY2I5Mjc0ZGNlYzBlMzQyYzZhMzZkNjgtMTQ4NDc1NjEzMjMwOS5tcDQ=?b=480&mmsid=220321398&tm=1494405157&pip=1b84500ac5c37676f85384fcf2c42daf&key=c09efe6421aeb7159b5d39b5fbc8cbe6&platid=2&splatid=206&payff=0&cuid=100001&vtype=13&dur=8890&p1=3&p2=31&p3=310&cf=h5-android&p=101&playid=0&tss=no&tag=mobile&sign=bcloud_100001&termid=2&pay=0&ostype=android&hwtype=un&ajax=1",options:{controls:!0,autoplay:!1,preload:"auto",width:1200,height:600}},t||{});if(!(jQuery.browser.msie&&~~jQuery.browser.version<=9)){var a=null,n=jQuery(this);n.addClass("d-current"),function(){var t=$("div[id^=video_]");if(t&&t.length>0)for(var o=0,i=t.length;o<i;o++){var r=t[o];videojs(r).dispose()}n.find(e.videoButton).click(function(){n.find(e.videoNodePar).append('<video id="video_demo" class="video-js vjs-default-skin"></video>'),a=videojs(e.videoNode,e.options,function(){var t=this;t.src({type:e.type,src:e.src}),t.play(),t.on("error",function(){t.dispose()})})})}()}},getCouponThisPage:function(t){var e=$.extend({couponItem:".J_couponItem",roleIdAttr:"data-ruleid",keyAttr:"data-key",couponImg:".J_couponImg"},t||{}),a=$(this);a.find(e.couponItem).each(function(){var t,a,n=$(this),o=n.attr("href");if("string"==typeof o&&-1!==o.indexOf("roleId=")){t=o.match(/roleId=[^&]+/)[0],t=t.slice(7,t.length),a=o.match(/key=[^&]+/)[0],a=a.slice(4,a.length);var i={};i[e.roleIdAttr]=t,i[e.keyAttr]=a,n.attr(i)}}),a.undelegate(e.couponItem,"click"),a.undelegate(e.couponImg,"click"),a.delegate(e.couponImg,"click",function(){return $(this).siblings(e.couponItem).trigger("click"),!1}),a.delegate(e.couponItem,"click",function(){var t=$(this),a=t.attr(e.keyAttr),n=t.attr(e.roleIdAttr);t.removeAttr("href"),"yhd"===$("#JSHOP_CHANNEL_FLAG").val()?$.ajax({url:"//channel.m.yhd.com/api/generateCoupon.do",data:{ruleId:n,key:a},timeout:3e3,type:"GET",dataType:"jsonp",success:function(e){999==e.code?t.removeClass("state-999").addClass("state-15").show():8==e.code||10008==e.code?location.href="//passport.yhd.com/passport/login_input.do":alert(e.message)},error:function(){alert("活动太火爆，过会儿再来吧！")}}):$.ajax({url:INTERFACE.actJshop.couponSend,data:{roleId:n,key:a},type:"GET",timeout:3e3,dataType:"jsonp",success:function(e){999==e.code?t.removeClass("state-999").addClass("state-15").show():-1==e.code?thick_login(function(){location.href=location.href}):15==e.code||14==e.code?(t.removeClass("state-999").addClass("state-15").show(),alert(e.desc)):alert(e.desc)},error:function(){alert("活动太火爆，过会儿再来吧！")}})})},getCouponState:function(t){for(var e=$.extend({couponItem:".J_couponItem",couponOffWarp:".J_offWarp",couponOffText:".J_offText",offClassName:"state-15",stateName:"state-"},t||{}),a=$(this),n=[],o=a.find(e.couponItem),i={8:"已结束",9:"未开始",10:"今日未开始",11:"今日已结束",14:"已领取",15:"今日已领取",16:"今日已抢完",17:"已抢完"},r=0;r<o.length;r++)n.push('{"id":"'+$(o[r]).data("ruleid")+'","encryptedKey":"'+$(o[r]).data("key")+'"}');jQuery.when(function(t){var e=jQuery.Deferred();return jQuery.ajax({url:INTERFACE.actJshop.couponState,dataType:"jsonp",data:{rulewithkey:t,pin:CookieUtil.getCookie("pin")},success:function(t){e.resolve(t)}}),e.promise()}("["+n.join(",")+"]")).done(function(t){t.forEach(function(a){var n=a.state;"999"==n?$("[data-ruleid="+a.ruleId+"]").addClass(e.stateName+n):i[n]?$("[data-ruleid="+a.ruleId+"]").addClass(e.stateName+n).find(e.couponOffText).text(i[n]):39===n&&"view"===$("#pageType").val()&&$("[data-ruleid="+t[r].ruleId+"]").each(function(){"139"===$(this).closest("[modeid]").attr("modeid")&&$(this).closest(".j-module").hide()})})})},getUserExdInfo:function(t){var e=$.Deferred();$.extend({},t||{}),$.ajax({url:INTERFACE.actJshop.userExd,dataType:"jsonp",success:function(t){e.resolve(t)},error:function(t){e.resolve()}});return e.promise()},userExd:function(t){var e=$.extend({renderNode:".J_render",tplNode:".J_tpl",noLoginNode:".J_noLogin"},t||{}),a=$(this);jshop.module.getUserExdInfo().done(function(t){var n=$(e.tplNode).html();seajs.use("public/utils/JsonUtils",function(o){var i=o.render(t,n);a.find(e.renderNode).html(i),a.delegate(e.noLoginNode,"click",function(){thick_login(function(){location.href=location.href})})})})},getYushouInfo:function getYushouInfo(args){function getData(){for(var skus=[],_i2=0;param.skuInfo[_i2];_i2++)skus.push(param.skuInfo[_i2].sku);for(var len=Math.ceil(skus.length/param.num),i=0;i<len;i++){var skuFragment=skus.slice(i*param.num,Math.min(skus.length,(i+1)*param.num));jQuery.ajax({url:INTERFACE.youshouinfoList,data:{sku:skuFragment.join(",")},dataType:"jsonp",success:function success(data){var data=eval(data);for(var n in data)data[n]=JSON.parse(data[n]);var _data=handleData(data);renderDom(_data)}})}}function handleData(t){for(var e=[],a=0;param.skuInfo[a];a++)for(var n in t)if(param.skuInfo[a].sku==n){if(t[n].imageUrl=param.skuInfo[a].imageUrl,t[n].urlItem=param.skuInfo[a].url,t[n].name=param.skuInfo[a].name,t[n].error&&(t[n].currentPrice='<span jshop="price" class="jdNum" jdprice="'+param.skuInfo[a].sku+'">&nbsp;</span>',t[n].cartFont="立即购买"),"1"==t[n].type)switch(t[n].currentPrice=param.skuInfo[a].price&&param.skuInfo[a].price.length>0?completionPrice(param.skuInfo[a].price):'<span jshop="price" class="jdNum" jdprice="'+param.skuInfo[a].sku+'">&nbsp;</span>',t[n].state){case 1:t[n].cartFont="等待预约";break;case 2:t[n].cartFont="立即预约";break;case 3:t[n].cartFont="等待抢购";break;case 4:t[n].cartFont="立即抢购";break;case 5:t[n].cartFont="抢购结束"}if("2"==t[n].type){switch(t[n].ret.s){case 0:t[n].cartFont="等待预定",t[n].urlCart=param.skuInfo[a].url;break;case 1:t[n].cartFont="立即预定",t[n].urlCart="//cart.jd.com/cart/dynamic/gateForSubFlow.action?wids="+n+"&nums=1&subType=32";break;case 2:t[n].cartFont="预定结束"}t[n].currentPrice=completionPrice(t[n].ret.cp),t[n].earnest=completionPrice(t[n].ret.pm),t[n].expAmount=t[n].ret.expAmount,t[n].depositWorth=t[n].ret.depositWorth,2==t[n].ret.t&&(t[n].stepOnePrice=completionPrice(t[n].ret.sa[0].m),t[n].stepTwoPrice=completionPrice(t[n].ret.sa[1].m),t[n].stepThreePrice=completionPrice(t[n].ret.sa[2].m)),2==t[n].ret.t&&(t[n]=setProgress(t[n]))}e.push(t[n])}return e}function completionPrice(t){if(t){var e=t.toString().split(".");e[1]?e[1]&&e[1].length<2&&(t+="0"):t+=".00"}else t="暂无定价";return t}function setProgress(t){var e=t.ret.sa[0].c,a=t.ret.sa[1].c,n=t.ret.sa[2].c,o=t.ret.cs,i=t.ret.cc;if(1==o)if(i>=e){var r=parseInt(1*i/a*54);t.progress=r}else t.progress=0;else if(2==o&&i>=a){var r=parseInt(1*(i-a)/(n-a)*54);t.progress=r}return t}function hoverClass(){_this.find("li").hover(function(){jQuery(this).addClass(param.hover)},function(){jQuery(this).removeClass(param.hover)})}function renderDom(t){seajs.use("public/utils/JsonUtils",function(e){var a=e.render(t,domTemplateHtml);_this.find(param.domCon).append(a).addClass(param.current),_this.find(param.domTemplateHtml).remove(),jshop.module.autoQuene.call(_this,param),bindCountDown(),hoverClass(),jQuery(document).trigger("newDomLoad",_this.closest("[module-name=forwardSale]"))})}function bindCountDown(){var node=_this.find('[module-function="countdown"]');node.each(function(i,e){jshop.module.countdown.call(jQuery(e),eval("("+jQuery(e).attr("module-param")+")"))})}var param=jQuery.extend({domCon:".d-con",domTemplateHtml:"#J_TemplateHtml",current:"current",hover:"li-hover",num:20,skuInfo:[]},args||{}),_this=jQuery(this),domTemplateHtml=_this.find(param.domTemplateHtml).html();0==param.skuInfo.length&&param.skuInfo.length>100||getData()},biAds:function biAds(args){function _getData(sucaiIds){function biRequest(){var t=$.ajax({url:INTERFACE.apim.client,data:{body:JSON.stringify(parm),functionId:functionId,uuid:uuid,client:"wh5",clientVersion:"1.0.0",activeFlag:!0,sourceCode:"jshop",platform:"PC",activityId:ids.join(","),area:CookieUtil.getCookie("ipLoc-djd")?CookieUtil.getCookie("ipLoc-djd").replace(/-/g,",").replace(/\.[0-9]+$/g,""):0},dataType:"jsonp",timeout:timer,success:_Success,complete:function(e,a){"timeout"==a&&(t.abort(),$.ajax({url:"//sale1.jd.com/backdata",data:{ids:ids.join(",")},dataType:"jsonp",success:_Success}))},error:function(){$.ajax({url:"//sale1.jd.com/backdata",data:{ids:ids.join(",")},dataType:"jsonp",success:_Success})}})}function _Success(data){sucaiIds.length>0&&_getData(sucaiIds),"0"==data.code&&data.advertInfos&&data.advertInfos.length>0&&seajs.use("public/utils/JsonUtils",function(Tool){for(var i=0,ii=data.advertInfos.length;i<ii;i++){var groupArr=data.advertInfos[i].list,curDom=_this.find('[data-groupid="'+data.advertInfos[i].groupId+'"]'),tpl=curDom.html(),arg={},Obj={},dataArr=[];if(!(groupArr.length<1||curDom.length<1)){try{arg=eval("("+curDom.closest("[module-param]").attr("module-param")+")")}catch(t){arg={}}for(var k=0,kk=groupArr.length;k<kk;k++)dataArr.push(groupArr[k]);Obj.list=dataArr;var rendered=Tool.render(Obj,tpl);""!==$.trim(rendered)&&curDom.replaceWith('<ul class="clearfix" groupid="'+data.advertInfos[i].groupId+'">'+rendered+"</ul>")}}var resultHtml=_this.html();promise.resolve(resultHtml)})}for(var moduleIdDids={},ids=sucaiIds.splice(0,15),i=0,ii=ids.length;i<ii;i++){var inId=instanceids[ids[i]];moduleIdDids[inId]=""}var parm={sysCode:Channel,ids:ids.join(","),currentStageFlag:"Y",avatar:$.base64.btoa(pin),pageId:$("#pageInstance_id").val(),moduleIdDids:moduleIdDids,previewTime:previewTime,mcChannel:1};biRequest()}var appIdArr=["881943","1007294"],Channel=$("#JSHOP_CHANNEL_FLAG").val(),promise=$.Deferred(),_dom=this,instanceids={},sucaiIds=$(this).attr("data-sucaiid").split(","),timer=3e3,pin=CookieUtil.getCookie("pin")||"",uuid=CookieUtil.getCookie("__jda")?CookieUtil.getCookie("__jda").split(".")[1]:"",previewTime=$.getUrlParam("beginTime")||"",functionId="preview"==$("#pageType").val()?"previewMaterialAdverts":"queryPcBabelAdverts",_this=$(this),instanceid=_this.closest("div[instanceid]").attr("instanceid"),groupId=$.trim(_this.find(".js-bitemplate").attr("data-groupid"));try{_param=eval("("+_this.attr("module-param")+")")}catch(t){_param={}}return timer=3e3,instanceids[groupId]=instanceid,$.base64.utf8encode=!0,_getData(sucaiIds),promise.promise()}},Array.prototype.has=function(t){for(var e=0,a=this.length;e<a;e++)if(this[e]===t)return!0;return!1},jQuery.fn.extend({adaptiveLayout:function(t){if(!jQuery(this).data("adaptiveLayout")){var e=jQuery.extend({node:null},t),a=jQuery(this).find(e.node),n=parseInt(a.parent().width()/a.outerWidth(!0)),o=jQuery.browser.msie&&parseInt(jQuery.browser.version)<=7?"i":"",i="padding"==arguments[1]?"p":"m",r=.5==arguments[2]?"OneHalf":"One";switch(n){case 10:jQuery(a).addClass(o+"qTen"+r).addClass(i+r);break;case 9:jQuery(a).addClass(o+"qNine"+r).addClass(i+r);break;case 8:jQuery(a).addClass(o+"qEight"+r).addClass(i+r);break;case 7:jQuery(a).addClass(o+"qSeven"+r).addClass(i+r);break;case 6:jQuery(a).addClass(o+"qSix"+r).addClass(i+r);break;case 5:jQuery(a).addClass(o+"qFive"+r).addClass(i+r);break;case 4:jQuery(a).addClass(o+"qFour"+r).addClass(i+r);break;case 3:jQuery(a).addClass(o+"qThree"+r).addClass(i+r);break;case 2:jQuery(a).addClass(o+"qTwo"+r).addClass(i+r);break;case 1:jQuery(a).addClass(o+"qOne"+r).addClass(i+r);break;default:jQuery(".app_edit_page_operate20130305")[0]&&jQuery(this).defaultMessage()}jQuery(this).data("adaptiveLayout",!0)}},insertMessage:function(){jQuery(this).prepend(jQuery("<div class='message_remind'>你选择的模板不适合这个布局，请重新选择模板！</div>").show())},defaultMessage:function(){var t=this;jQuery(this).insertMessage(),setTimeout(function(){jQuery(t).find(".message_remind").remove()},1e4)},imgOnload:function(t,e){jQuery(this).parents(".mc").eq(0).adaptiveLayout({node:"li"},t,e)}}),function(t,e,a){function n(t){var a=e.extend({box:e(".marquee"),step:5,el:"ul",itemClass:".item",inteval:30},t);this.get=function(t){return a[t]},this.set=function(t,e){a[t]=e}}n.prototype={constructor:n,init:function(){this.parseNode(),this.startScroll(),this.bindEvent()},parseNode:function(){var t=this.get("box"),e=t.find(this.get("el"));this.set("elHeight",e.height()),e.height()>t.height()&&("static"===t.css("position")&&(t.css("position","relative"),e.css({position:"absolute",top:"0"})),t.find(this.get("itemClass")).each(function(t,e){var a=$(e).clone();$(e).parent().append(a)}))},startScroll:function(){var t=this,e=t.get("_timer"),a=t.get("box").find(t.get("el")),n=t.get("step");e&&(clearInterval(e),t.set("_timer",null)),e=setInterval(function(){var e=parseFloat(a.css("top")),o=Math.abs(e-n)>t.get("elHeight")?0:e-n;a.css("top",o)},t.get("interval")),t.set("_timer",e)},stopScroll:function(){var t=this,e=t.get("_timer");e&&(clearInterval(e),t.set("_timer",null))},bindEvent:function(){var t=this;t.get("box").mouseover(function(e){return t.stopScroll(),!1}).mouseout(function(e){return t.startScroll(),!1})}},t.SeamlessScroll=n}(window,jQuery);